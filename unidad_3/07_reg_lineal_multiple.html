<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Christian Ballejo">
<meta name="author" content="Andrea Silva">
<meta name="author" content="Tamara Ricardo">
<title>Regresión lineal múltiple – Curso Epidemiología - Nivel Avanzado</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="../site_libs/typedarray-0.1/typedarray.min.js"></script><script src="../site_libs/jquery-3.5.1/jquery.min.js"></script><link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<style type="text/css">
.quarto-reader-toggle .bi::before, .quarto-color-scheme-toggle .bi::before {
  display: inline-block;
  height: 40px;
  width: 40px;
  background-size: 20px 20px;
  background-position: center;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgba(189, 195, 199, 1)" class="bi bi-moon-stars-fill" viewbox="0 0 16 16"> <path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"></path> <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"></path> </svg>') !important;
}
</style>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-announcement" data-announcement-id="4ab7ce5ee7c696df0f91065161a52a26" class="alert alert-dark hidden">
<i class="bi bi-file-pdf-fill quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>Guardar como PDF: presione <strong>CTRL</strong> + <strong>P</strong></p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-curso-de-epidemiología-nivel-avanzado" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Curso de Epidemiología: Nivel Avanzado</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-curso-de-epidemiología-nivel-avanzado">
<li>
    <a class="dropdown-item" href="../unidad_1/01_intro_R.html">
 <span class="dropdown-text">Unidad 1: Introducción a R</span></a>
  </li>  
        <li class="dropdown-header">Unidad 2: Estudios transversales</li>
        <li class="dropdown-header">Unidad 3: Estudios ecológicos</li>
        <li class="dropdown-header">Unidad 4: Estudios de casos y controles</li>
        <li class="dropdown-header">Unidad 5: Estudios de cohortes</li>
        <li class="dropdown-header">Unidad 6: Estudios experimentales</li>
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-descargas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-cloud-download" role="img">
</i> 
 <span class="menu-text">Descargas</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-descargas">
<li>
    <a class="dropdown-item" href="https://cran.rstudio.com/bin/windows/" target="_blank"><i class="bi bi-windows" role="img">
</i> 
 <span class="dropdown-text">R para Windows</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://cran.rstudio.com/bin/macosx/" target="_blank"><i class="bi bi-apple" role="img">
</i> 
 <span class="dropdown-text">R para macOS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://cran.rstudio.com/bin/linux/" target="_blank"><i class="bi bi-ubuntu" role="img">
</i> 
 <span class="dropdown-text">R para Linux</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://posit.co/download/rstudio-desktop/" target="_blank"><i class="bi bi-terminal" role="img">
</i> 
 <span class="dropdown-text">RStudio Desktop</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://cran.r-project.org/bin/windows/Rtools/" target="_blank"><i class="bi bi-terminal" role="img">
</i> 
 <span class="dropdown-text">RTools</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../files/datos_y_paquetes.zip"><i class="bi bi-file-zip" role="img">
</i> 
 <span class="dropdown-text">Paquetes y datos para el curso</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Regresión lineal múltiple</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true"><i class="bi bi-file-earmark-bar-graph" role="img">
</i> 
 <span class="menu-text">Unidad 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unidad_1/01_intro_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unidad_1/02_intro_RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primeros pasos y generalidades</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unidad_1/03_intro_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unidad_1/04_analisis_exploratorio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis exploratorio de datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unidad_1/05_hoja_estilo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hoja de Estilo del lenguaje R</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contenidos</h2>
   
  <ul>
<li><a href="#introducci%C3%B3n" id="toc-introducción" class="nav-link active" data-scroll-target="#introducci%C3%B3n">Introducción</a></li>
  <li>
<a href="#presupuestos-del-modelo-de-rlm" id="toc-presupuestos-del-modelo-de-rlm" class="nav-link" data-scroll-target="#presupuestos-del-modelo-de-rlm">Presupuestos del modelo de RLM</a>
  <ul class="collapse">
<li><a href="#independencia" id="toc-independencia" class="nav-link" data-scroll-target="#independencia">Independencia</a></li>
  <li><a href="#linealidad" id="toc-linealidad" class="nav-link" data-scroll-target="#linealidad">Linealidad</a></li>
  <li><a href="#homocedasticidad" id="toc-homocedasticidad" class="nav-link" data-scroll-target="#homocedasticidad">Homocedasticidad</a></li>
  <li><a href="#normalidad" id="toc-normalidad" class="nav-link" data-scroll-target="#normalidad">Normalidad</a></li>
  </ul>
</li>
  <li>
<a href="#interpretaci%C3%B3n-del-modelo" id="toc-interpretación-del-modelo" class="nav-link" data-scroll-target="#interpretaci%C3%B3n-del-modelo">Interpretación del modelo</a>
  <ul class="collapse">
<li><a href="#test-f-parcial" id="toc-test-f-parcial" class="nav-link" data-scroll-target="#test-f-parcial">Test F parcial</a></li>
  <li><a href="#varianza-residual" id="toc-varianza-residual" class="nav-link" data-scroll-target="#varianza-residual">Varianza residual</a></li>
  <li><a href="#test-f-global" id="toc-test-f-global" class="nav-link" data-scroll-target="#test-f-global">Test F global</a></li>
  <li><a href="#coeficiente-de-determinaci%C3%B3n" id="toc-coeficiente-de-determinación" class="nav-link" data-scroll-target="#coeficiente-de-determinaci%C3%B3n">Coeficiente de determinación</a></li>
  </ul>
</li>
  <li><a href="#variables-dummy" id="toc-variables-dummy" class="nav-link" data-scroll-target="#variables-dummy">Variables <em>dummy</em></a></li>
  <li><a href="#estimaci%C3%B3n-y-predicci%C3%B3n-en-modelos-de-regresi%C3%B3n" id="toc-estimación-y-predicción-en-modelos-de-regresión" class="nav-link" data-scroll-target="#estimaci%C3%B3n-y-predicci%C3%B3n-en-modelos-de-regresi%C3%B3n">Estimación y predicción en modelos de regresión</a></li>
  <li>
<a href="#lineamientos-la-selecci%C3%B3n-del-modelo-de-regresi%C3%B3n" id="toc-lineamientos-la-selección-del-modelo-de-regresión" class="nav-link" data-scroll-target="#lineamientos-la-selecci%C3%B3n-del-modelo-de-regresi%C3%B3n">Lineamientos la selección del modelo de regresión</a>
  <ul class="collapse">
<li><a href="#identificaci%C3%B3n-de-variables-potencialmente-predictivasexplicativas" id="toc-identificación-de-variables-potencialmente-predictivasexplicativas" class="nav-link" data-scroll-target="#identificaci%C3%B3n-de-variables-potencialmente-predictivasexplicativas">Identificación de variables potencialmente predictivas/explicativas</a></li>
  <li><a href="#colinealidad" id="toc-colinealidad" class="nav-link" data-scroll-target="#colinealidad">Colinealidad</a></li>
  <li><a href="#selecci%C3%B3n-de-variables" id="toc-selección-de-variables" class="nav-link" data-scroll-target="#selecci%C3%B3n-de-variables">Selección de variables</a></li>
  <li><a href="#selecci%C3%B3n-de-modelos" id="toc-selección-de-modelos" class="nav-link" data-scroll-target="#selecci%C3%B3n-de-modelos">Selección de modelos</a></li>
  </ul>
</li>
  <li>
<a href="#validaci%C3%B3n-y-diagn%C3%B3stico-del-modelo" id="toc-validación-y-diagnóstico-del-modelo" class="nav-link" data-scroll-target="#validaci%C3%B3n-y-diagn%C3%B3stico-del-modelo">Validación y diagnóstico del modelo</a>
  <ul class="collapse">
<li><a href="#normalidad-1" id="toc-normalidad-1" class="nav-link" data-scroll-target="#normalidad-1">Normalidad</a></li>
  <li><a href="#homocedasticidad-y-linealidad" id="toc-homocedasticidad-y-linealidad" class="nav-link" data-scroll-target="#homocedasticidad-y-linealidad">Homocedasticidad y linealidad</a></li>
  <li><a href="#valores-de-influencia-leverage" id="toc-valores-de-influencia-leverage" class="nav-link" data-scroll-target="#valores-de-influencia-leverage">Valores de influencia (<em>leverage</em>)</a></li>
  <li><a href="#distancia-de-cook" id="toc-distancia-de-cook" class="nav-link" data-scroll-target="#distancia-de-cook">Distancia de Cook</a></li>
  <li><a href="#independencia-de-residuos" id="toc-independencia-de-residuos" class="nav-link" data-scroll-target="#independencia-de-residuos">Independencia de residuos</a></li>
  </ul>
</li>
  <li>
<a href="#ejemplo-pr%C3%A1ctico-en-r" id="toc-ejemplo-práctico-en-r" class="nav-link" data-scroll-target="#ejemplo-pr%C3%A1ctico-en-r">Ejemplo práctico en R</a>
  <ul class="collapse">
<li><a href="#lectura-de-datos-y-visualizaci%C3%B3n-de-estructura" id="toc-lectura-de-datos-y-visualización-de-estructura" class="nav-link" data-scroll-target="#lectura-de-datos-y-visualizaci%C3%B3n-de-estructura">Lectura de datos y visualización de estructura</a></li>
  <li><a href="#an%C3%A1lisis-de-variables-potencialmente-explicativas" id="toc-análisis-de-variables-potencialmente-explicativas" class="nav-link" data-scroll-target="#an%C3%A1lisis-de-variables-potencialmente-explicativas">Análisis de variables potencialmente explicativas</a></li>
  <li><a href="#estrategia-de-construcci%C3%B3n-del-modelo" id="toc-estrategia-de-construcción-del-modelo" class="nav-link" data-scroll-target="#estrategia-de-construcci%C3%B3n-del-modelo">Estrategia de construcción del modelo</a></li>
  <li><a href="#comparaci%C3%B3n-de-modelos" id="toc-comparación-de-modelos" class="nav-link" data-scroll-target="#comparaci%C3%B3n-de-modelos">Comparación de modelos</a></li>
  <li><a href="#colinealidad-1" id="toc-colinealidad-1" class="nav-link" data-scroll-target="#colinealidad-1">Colinealidad</a></li>
  <li><a href="#an%C3%A1lisis-de-residuales" id="toc-análisis-de-residuales" class="nav-link" data-scroll-target="#an%C3%A1lisis-de-residuales">Análisis de residuales</a></li>
  <li><a href="#resumen-del-mejor-modelo-elegido" id="toc-resumen-del-mejor-modelo-elegido" class="nav-link" data-scroll-target="#resumen-del-mejor-modelo-elegido">Resumen del mejor modelo elegido</a></li>
  </ul>
</li>
  <li><a href="#funciones-para-modelado-autom%C3%A1tico" id="toc-funciones-para-modelado-automático" class="nav-link" data-scroll-target="#funciones-para-modelado-autom%C3%A1tico">Funciones para modelado automático</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Regresión lineal múltiple</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autores/as</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Ballejo <a href="https://orcid.org/0000-0002-7346-5701" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Andrea Silva <a href="https://orcid.org/0000-0002-4791-9706" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Tamara Ricardo <a href="https://orcid.org/0000-0002-0921-2611" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
  
    
  </div>
  


</header><section id="introducción" class="level2"><h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Los modelos de Regresión Lineal Múltiple (RLM) son herramientas estadísticas ampliamente utilizadas cuando la variable dependiente es continua y existen dos o más variables independientes, que pueden ser tanto continuas como categóricas. En el caso de las covariables categóricas, estas pueden ser dicotómicas, ordinales o tener múltiples niveles.</p>
<p>Al igual que la Regresión Lineal Simple (RLS), que permite estimar el efecto bruto de una variable independiente sobre la variable dependiente, la RLM nos permite conocer el efecto conjunto de dos o más variables independientes (<span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…<span class="math inline">\(X_k\)</span>) sobre la variable dependientea (<span class="math inline">\(Y\)</span>). De esta manera, la RLM nos permite:</p>
<ul>
<li><p><strong>Analizar la dirección y fuerza de la asociación</strong> entre la variable dependiente y las variables independientes.</p></li>
<li><p><strong>Identificar las variables independientes importantes</strong> en la predicción o explicación de la variable dependiente.</p></li>
<li><p><strong>Describir la relación entre una o más variables independientes</strong>, controlando la confusión.</p></li>
<li><p><strong>Detectar interacciones</strong>, es decir, cómo cambia la relación entre la variable dependiente y una variable independiente según el nivel de otra variable independiente.</p></li>
</ul>
<p>El modelo estadístico de la RLS que expresa la relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> es:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1X_1
\]</span></p>
<p>Este modelo se representa gráficamente como una recta de ajuste en un plano bidimensional (dos dimensiones).</p>
<p>Por otro lado, el modelo estadístico de la RLM es:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ...+\beta_kX_k  
\]</span></p>
<p>Donde <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>,…,<span class="math inline">\(\beta_k\)</span> son los parámetros de la regresión. Para cada combinación de valores de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…<span class="math inline">\(X_k\)</span> existe una distribución <span class="math inline">\(Y\)</span> cuya <strong>media</strong> es una función lineal de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…, <span class="math inline">\(X_k\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_reg_lineal_multiple_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>La representación gráfica de la recta de ajuste en la regresión lineal múltiple se realiza en un espacio de dimensión <span class="math inline">\(K + 1\)</span>, donde <span class="math inline">\(K\)</span> es el número de variables independientes. En el caso de la regresión lineal simple (RLS), la relación se puede representar fácilmente en un plano bidimensional (2D). Sin embargo, a medida que aumentamos el número de variables independientes, la representación gráfica se vuelve más compleja, ya que requerimos más dimensiones, lo que dificulta visualizar el modelo en el espacio.</p>
<p>En el caso puntual que el modelo tuviera 2 variables independientes, la ecuación sería:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2X_2
\]</span></p>
<p>En este caso, la relación podría representarse en un plano tridimensional (3D), donde los ejes corresponden a <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> y la variable dependiente <span class="math inline">\(Y\)</span>. En este plano, la superficie de ajuste es un plano que describe la relación entre las tres variables, y la orientación de dicho plano estará determinada por los coeficientes <span class="math inline">\(\beta_1\)</span> y <span class="math inline">\(\beta_2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7ea80b0746f80e52b0ea" style="width:85%;height:1500px;"></div>
<script type="application/json" data-for="htmlwidget-7ea80b0746f80e52b0ea">{"x":{"visdat":{"60038d43756":["function () ","plotlyVisDat"]},"cur_data":"60038d43756","attrs":{"60038d43756":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","error_x":{"array":[-0.35762109361139816,-0.376344484108871,-0.46926935180344692,-0.52625663966936831,-0.21857976659019943,0.16558958647949093,-1.00710524896036,0.10599021668614589,0.61833752320828517,1.0187870091202176,0.65058799610029361,0.37838738189798077,-0.86336519955716495,-0.30075335400339098,-0.17602322829130843,0.35176195137844724,-0.052835667001887236,-0.62932431403008593,0.8422178540470574,0.45569564589798134,0.11871513624551289,0.60905430516290571,-0.66938714361748619,0.33041014889490017,-0.26145618815671096,0.34187276092535623,-0.030410977330037114,0.31648035651572543,0.66775880752969596,0.0036450451584493972,0.50877931847604618,-0.59421701757398948,-0.36080222021800762,0.75960885569408909,0.18869398651196465,-1.0261114102168649,-0.68201872604118763,-0.1003905077945606,0.43288970216724398,-0.050941627857611235,0.31209373601032636,0.47950268889391268,0.83552741443146961,0.028008366637480967,-0.025990953090449485,-0.87661867957113482,0.049663797043913743,-0.28592502894778166,-0.48700479140204561,-0.089953115523770152,0.50747158637182876,-0.99637424434429123,-0.21363964360271434,0.05831864179135321,-0.4466037850274765,0.16695147124961254,0.20571496030786535,-0.016518079637995873,-1.2329490968800136,1.2857290729333188,-0.10264962873409975,0.32559664079383516,0.13688324551827399,0.51233661740917513,0.40882972318704397,-0.10489658561425431,0.1890838861042535,-0.47270441556194642,0.42846150544965922,-0.23051916944217701,1.2083866768941054,-0.82552444784409362,-0.23199362148300745,0.41268993137962123,0.25506627343933175,-0.29474051925750017,-0.49839037110376117,0.072237852355348325,-0.0071537065834566937,-0.89514061863203009,0.017275533566925513,0.095115157846228551,0.087363198490920779,-0.52750852130134074,0.23806663915131451,0.68928506847962023,0.22811820158990626,-0.56779423518717154,-0.21782273484595252,0.17305180977680337,-0.32352281565913449,-1.0788231675076385,0.44212541001410449,-0.41473880581225903,-0.28678013538414143,0.75195030450226752,-0.38707246480270252,0.42286577009464793,-0.63034143940938769,-0.17727120153698886]},"error_y":{"array":[-0.35762109361139816,-0.376344484108871,-0.46926935180344692,-0.52625663966936831,-0.21857976659019943,0.16558958647949093,-1.00710524896036,0.10599021668614589,0.61833752320828517,1.0187870091202176,0.65058799610029361,0.37838738189798077,-0.86336519955716495,-0.30075335400339098,-0.17602322829130843,0.35176195137844724,-0.052835667001887236,-0.62932431403008593,0.8422178540470574,0.45569564589798134,0.11871513624551289,0.60905430516290571,-0.66938714361748619,0.33041014889490017,-0.26145618815671096,0.34187276092535623,-0.030410977330037114,0.31648035651572543,0.66775880752969596,0.0036450451584493972,0.50877931847604618,-0.59421701757398948,-0.36080222021800762,0.75960885569408909,0.18869398651196465,-1.0261114102168649,-0.68201872604118763,-0.1003905077945606,0.43288970216724398,-0.050941627857611235,0.31209373601032636,0.47950268889391268,0.83552741443146961,0.028008366637480967,-0.025990953090449485,-0.87661867957113482,0.049663797043913743,-0.28592502894778166,-0.48700479140204561,-0.089953115523770152,0.50747158637182876,-0.99637424434429123,-0.21363964360271434,0.05831864179135321,-0.4466037850274765,0.16695147124961254,0.20571496030786535,-0.016518079637995873,-1.2329490968800136,1.2857290729333188,-0.10264962873409975,0.32559664079383516,0.13688324551827399,0.51233661740917513,0.40882972318704397,-0.10489658561425431,0.1890838861042535,-0.47270441556194642,0.42846150544965922,-0.23051916944217701,1.2083866768941054,-0.82552444784409362,-0.23199362148300745,0.41268993137962123,0.25506627343933175,-0.29474051925750017,-0.49839037110376117,0.072237852355348325,-0.0071537065834566937,-0.89514061863203009,0.017275533566925513,0.095115157846228551,0.087363198490920779,-0.52750852130134074,0.23806663915131451,0.68928506847962023,0.22811820158990626,-0.56779423518717154,-0.21782273484595252,0.17305180977680337,-0.32352281565913449,-1.0788231675076385,0.44212541001410449,-0.41473880581225903,-0.28678013538414143,0.75195030450226752,-0.38707246480270252,0.42286577009464793,-0.63034143940938769,-0.17727120153698886]},"showlegend":false,"inherit":true},"60038d43756.1":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","showscale":false,"opacity":0.75,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"X1"},"yaxis":{"title":"X2"},"zaxis":{"title":"Y"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-0.5604756465522126,-0.23017748948327996,1.558708314149124,0.070508391424576003,0.12928773516094624,1.715064986883281,0.4609162059892023,-1.265061234606534,-0.68685285189352607,-0.44566197009995806,1.2240817974394615,0.35981382705736381,0.40077145059405217,0.11068271594511971,-0.55584113475407493,1.7869131368030782,0.49785047822923939,-1.9666171566296382,0.70135590156368555,-0.47279140772793404,-1.0678237059868452,-0.21797491465829513,-1.0260044483072397,-0.72889122929114025,-0.62503926784925667,-1.6866933107424134,0.83778704449452468,0.15337311783651522,-1.1381369370119476,1.2538149210699268,0.42646422147681357,-0.29507148299227115,0.89512566104502223,0.87813348753304221,0.82158108163748711,0.688640254100091,0.55391765353758882,-0.061911710576721679,-0.30596266373991676,-0.38047100101238268,-0.6947069789205127,-0.20791727801959878,-1.2653963515682645,2.1689559653385126,1.2079619983049905,-1.1231085832033492,-0.40288483529907598,-0.46665535362321886,0.77996511833631788,-0.083369066471829276,0.2533185139947548,-0.028546755348703018,-0.04287045729131609,1.3686022840144576,-0.22577098565926762,1.5164706044295397,-1.5487528042302212,0.58461374963606916,0.12385424384461378,0.21594156874397272,0.37963948275988207,-0.50232345310930226,-0.3332073836694201,-1.0185753831070887,-1.0717912264755778,0.30352864140425806,0.44820977862942618,0.053004226730504145,0.92226746787973757,2.0500846856271444,-0.4910311660565353,-2.3091688756408124,1.0057385244622565,-0.70920076258239262,-0.688008616467358,1.0255713696966988,-0.28477300705100889,-1.2207177122545356,0.1813034797491502,-0.13889136243904462,0.005764185899886933,0.3852804011263305,-0.37066003179240936,0.64437654851883297,-0.22048656181875062,0.33178196391569692,1.0968390131493477,0.43518149083380286,-0.32593158553122675,1.1488076184510938,0.99350385596211943,0.54839695950806999,0.23873173511144119,-0.62790607603937143,1.3606524485300076,-0.60025958714712691,2.1873329930165766,1.5326106261851893,-0.23570035910047687,-1.0264209003067808],"y":[-0.710406563699301,0.25688370915652953,-0.24669187846237361,-0.34754259939773319,-0.9516185672650157,-0.045027724808920269,-0.78490446945707582,-1.6679419365881367,-0.38022652028776244,0.91899660906076597,-0.57534696260839191,0.60796432222503338,-1.617882708289164,-0.055561965524539438,0.51940720394346229,0.3011533621667144,0.10567619414894333,-0.64070600830537638,-0.84970434603358225,-1.0241287906049132,0.11764659710012587,-0.94747461418480217,-0.49055744370066834,-0.25609219219824725,1.8438620052322074,-0.65194990169545852,0.23538657228485693,0.077960849563710771,-0.96185663413012856,-0.071308086123598666,1.4445508584233488,0.45150405307921465,0.04123292199293993,-0.42249683233962482,-2.0532472215405155,1.1313372134141755,-1.460640070924822,0.73994751087733446,1.9091035692174834,-1.4438931609717993,0.70178433537471085,-0.26219748940246801,-1.5721441591454877,-1.5146676537817514,-1.6015361735745934,-0.53090652217030299,-1.4617555849958999,0.68791677297582754,2.1001089405256717,-1.2870304760351789,0.78773884747517808,0.7690422410009099,0.33220257895011768,-1.0083766082770078,-0.11945260663065868,-0.28039533517024667,0.56298953322047984,-0.37243875610382904,0.97697338668562073,-0.37458085776701383,1.0527114655793319,-1.0491770066660657,-1.2601552447581124,3.2410399349424046,-0.41685758816043178,0.29822759154071532,0.63656967403384868,-0.48378062570874358,0.51686204431360905,0.36896452738508601,-0.21538050764169339,0.065293033525315264,-0.034067253738463997,2.1284518990161811,-0.74133609627282837,-1.0959962670746639,0.037788399171078818,0.31048074944313703,0.43652347891018295,-0.45836533271110569,-1.063326133971191,1.2631851760894901,-0.34965038795355474,-0.86551286265337402,-0.23627956894109653,-0.19717589434855221,1.1099202897136404,0.084737292197196459,0.75405378518452149,-0.49929201717226079,0.21444530958160127,-0.3246859114908347,0.094583528173571421,-0.89536335797754163,-1.3108015333279719,1.9972133847479665,0.60070882367241762,-1.251271361624944,-0.61116591668042086,-1.1854800845973104],"z":[-1.0533606353186085,1.6227091249365391,2.1121959362147744,-0.35841695611195801,-3.0106201793920144,2.8187999047242229,-2.2214838342430654,-8.1285655464369899,-0.8634777973136496,1.8116377618969413,0.84136794348133137,2.7872080503889198,-2.8196293451940502,-0.46138429562815919,-0.54596780806980039,6.1529832925094894,0.87156632200002337,-6.5784183081152792,-2.3826743538566686,-5.3026849095884039,-2.3566810999712997,-2.6603878547044681,-2.4138330887867663,-1.5184706813414344,3.9178501829028565,-5.2694863891866008,1.67713734216355,-0.17658937720984746,-4.2771932774373616,1.2781130051655134,7.1418749837161375,0.67404959928724995,2.1284889146980803,-0.24975122669236349,-5.0909681911098419,3.4542760161374666,-3.4570102940720155,2.5150015164030237,5.4396897243339959,-5.8741579719949142,-0.072682922570894593,-1.7046257425894624,-5.7511645107266407,-1.3433946513339736,-2.5677361184939977,-1.9365749112386803,-5.2920113109146598,-0.22940109214034909,7.1954876229755884,-3.5423695821443171,2.4942506987452706,1.6881568487555407,0.56694958813926144,-0.19742860966288728,0.78860897993531465,2.1031900912094557,-0.32773751264748552,0.68266534661121792,3.064988752239949,-2.2247614387036942,3.3962960447052399,-4.642048379355276,-4.39972606885165,8.9861677162798568,-1.1010762436013573,3.0493211164144314,2.6729776150314541,-3.1018608192228601,3.0063412046285589,5.2962701764828424,-0.78319085097071484,-3.4599306822214082,2.5935847171255855,3.5716798220842909,-2.7503824761198459,-1.6834032782578161,-0.28137811642752564,-1.4354419990059255,2.100344161199355,-1.6282037401852665,-4.8459251276994619,5.2966122952945733,-1.4042446590958073,-1.5734371162006786,-1.0316673194141099,0.20607489015420058,5.7444583640006188,2.765421024236681,1.3912478055576347,0.96780456927006275,3.7987275137381356,1.176917207920555,1.906477165123954,-4.5193702270709242,0.79138302736892863,4.8578218508798292,8.0436443017572685,-2.0394955185351646,-2.2839148818879789,-4.3593674834362766],"type":"scatter3d","mode":"markers","error_x":{"color":"rgba(31,119,180,1)","array":[-0.35762109361139816,-0.376344484108871,-0.46926935180344692,-0.52625663966936831,-0.21857976659019943,0.16558958647949093,-1.00710524896036,0.10599021668614589,0.61833752320828517,1.0187870091202176,0.65058799610029361,0.37838738189798077,-0.86336519955716495,-0.30075335400339098,-0.17602322829130843,0.35176195137844724,-0.052835667001887236,-0.62932431403008593,0.8422178540470574,0.45569564589798134,0.11871513624551289,0.60905430516290571,-0.66938714361748619,0.33041014889490017,-0.26145618815671096,0.34187276092535623,-0.030410977330037114,0.31648035651572543,0.66775880752969596,0.0036450451584493972,0.50877931847604618,-0.59421701757398948,-0.36080222021800762,0.75960885569408909,0.18869398651196465,-1.0261114102168649,-0.68201872604118763,-0.1003905077945606,0.43288970216724398,-0.050941627857611235,0.31209373601032636,0.47950268889391268,0.83552741443146961,0.028008366637480967,-0.025990953090449485,-0.87661867957113482,0.049663797043913743,-0.28592502894778166,-0.48700479140204561,-0.089953115523770152,0.50747158637182876,-0.99637424434429123,-0.21363964360271434,0.05831864179135321,-0.4466037850274765,0.16695147124961254,0.20571496030786535,-0.016518079637995873,-1.2329490968800136,1.2857290729333188,-0.10264962873409975,0.32559664079383516,0.13688324551827399,0.51233661740917513,0.40882972318704397,-0.10489658561425431,0.1890838861042535,-0.47270441556194642,0.42846150544965922,-0.23051916944217701,1.2083866768941054,-0.82552444784409362,-0.23199362148300745,0.41268993137962123,0.25506627343933175,-0.29474051925750017,-0.49839037110376117,0.072237852355348325,-0.0071537065834566937,-0.89514061863203009,0.017275533566925513,0.095115157846228551,0.087363198490920779,-0.52750852130134074,0.23806663915131451,0.68928506847962023,0.22811820158990626,-0.56779423518717154,-0.21782273484595252,0.17305180977680337,-0.32352281565913449,-1.0788231675076385,0.44212541001410449,-0.41473880581225903,-0.28678013538414143,0.75195030450226752,-0.38707246480270252,0.42286577009464793,-0.63034143940938769,-0.17727120153698886]},"error_y":{"color":"rgba(31,119,180,1)","array":[-0.35762109361139816,-0.376344484108871,-0.46926935180344692,-0.52625663966936831,-0.21857976659019943,0.16558958647949093,-1.00710524896036,0.10599021668614589,0.61833752320828517,1.0187870091202176,0.65058799610029361,0.37838738189798077,-0.86336519955716495,-0.30075335400339098,-0.17602322829130843,0.35176195137844724,-0.052835667001887236,-0.62932431403008593,0.8422178540470574,0.45569564589798134,0.11871513624551289,0.60905430516290571,-0.66938714361748619,0.33041014889490017,-0.26145618815671096,0.34187276092535623,-0.030410977330037114,0.31648035651572543,0.66775880752969596,0.0036450451584493972,0.50877931847604618,-0.59421701757398948,-0.36080222021800762,0.75960885569408909,0.18869398651196465,-1.0261114102168649,-0.68201872604118763,-0.1003905077945606,0.43288970216724398,-0.050941627857611235,0.31209373601032636,0.47950268889391268,0.83552741443146961,0.028008366637480967,-0.025990953090449485,-0.87661867957113482,0.049663797043913743,-0.28592502894778166,-0.48700479140204561,-0.089953115523770152,0.50747158637182876,-0.99637424434429123,-0.21363964360271434,0.05831864179135321,-0.4466037850274765,0.16695147124961254,0.20571496030786535,-0.016518079637995873,-1.2329490968800136,1.2857290729333188,-0.10264962873409975,0.32559664079383516,0.13688324551827399,0.51233661740917513,0.40882972318704397,-0.10489658561425431,0.1890838861042535,-0.47270441556194642,0.42846150544965922,-0.23051916944217701,1.2083866768941054,-0.82552444784409362,-0.23199362148300745,0.41268993137962123,0.25506627343933175,-0.29474051925750017,-0.49839037110376117,0.072237852355348325,-0.0071537065834566937,-0.89514061863203009,0.017275533566925513,0.095115157846228551,0.087363198490920779,-0.52750852130134074,0.23806663915131451,0.68928506847962023,0.22811820158990626,-0.56779423518717154,-0.21782273484595252,0.17305180977680337,-0.32352281565913449,-1.0788231675076385,0.44212541001410449,-0.41473880581225903,-0.28678013538414143,0.75195030450226752,-0.38707246480270252,0.42286577009464793,-0.63034143940938769,-0.17727120153698886]},"showlegend":false,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"y<br />matrix(grid$y, nrow = length(x1_grid), ncol = length(x2_grid))","ticklen":2},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666666","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"x":[-2.3091688756408124,-2.0725108825535816,-1.8358528894663504,-1.5991948963791194,-1.3625369032918884,-1.1258789102046574,-0.88922091711742635,-0.65256292403019533,-0.41590493094296432,-0.17924693785573309,0.057411055231497699,0.29406904831872849,0.53072704140595972,0.76738503449319095,1.0040430275804217,1.2407010206676525,1.4773590137548838,1.714017006842115,1.9506749999293462,2.1873329930165766],"y":[-2.0532472215405155,-1.7746005290940461,-1.4959538366475766,-1.2173071442011072,-0.93866045175463775,-0.6600137593081683,-0.38136706686169886,-0.10272037441522941,0.17592631803124004,0.45457301047770926,0.73321970292417893,1.0118663953706486,1.2905130878171178,1.569159780263587,1.8478064727100567,2.1264531651565264,2.4050998576029956,2.6837465500494648,2.9623932424959341,3.2410399349424046],"z":[[-10.384388897476088,-9.541813883526082,-8.6992388695760781,-7.8566638556260742,-7.0140888416760694,-6.1715138277260646,-5.3289388137760598,-4.486363799826055,-3.6437887858760507,-2.8012137719260464,-1.9586387579760411,-1.1160637440260359,-0.27348873007603203,0.56908628387397187,1.4116612978239775,2.2542363117739823,3.0968113257239862,3.939386339673991,4.7819613536239949,5.6245363675740023],[-9.9425890179300112,-9.1000140039800073,-8.2574389900300016,-7.4148639760799977,-6.5722889621299938,-5.7297139481799881,-4.8871389342299842,-4.0445639202799795,-3.2019889063299747,-2.3594138923799708,-1.5168388784299651,-0.6742638644799599,0.168311149470044,1.0108861634200479,1.8534611773700536,2.6960361913200583,3.5386112052700622,4.3811862192200675,5.2237612331700713,6.0663362471200788],[-9.5007891383839329,-8.658214124433929,-7.8156391104839242,-6.9730640965339195,-6.1304890825839156,-5.2879140686339108,-4.445339054683906,-3.6027640407339012,-2.7601890267838969,-1.9176140128338928,-1.0750389988838873,-0.2324639849338821,0.6101110290161218,1.4526860429661257,2.2952610569161314,3.1378360708661361,3.98041108481614,4.8229860987661448,5.6655611127161487,6.5081361266661562],[-9.0589892588378564,-8.2164142448878525,-7.3738392309378469,-6.531264216987843,-5.6886892030378391,-4.8461141890878334,-4.0035391751378295,-3.1609641611878248,-2.31838914723782,-1.4758141332878159,-0.63323911933781041,0.20933589461219482,1.0519109085621987,1.8944859225122026,2.7370609364622083,3.5796359504122131,4.4222109643622165,5.2647859783122222,6.1073609922622261,6.9499360062122335],[-8.61718937929178,-7.7746143653417743,-6.9320393513917704,-6.0894643374417656,-5.2468893234917608,-4.404314309541757,-3.5617392955917517,-2.7191642816417474,-1.8765892676917426,-1.0340142537417385,-0.19143923979173305,0.65113577415827217,1.4937107881082761,2.33628580205828,3.1788608160082856,4.0214358299582909,4.8640108439082947,5.7065858578582986,6.5491608718083025,7.39173588575831],[-8.1753894997457017,-7.3328144857956978,-6.4902394718456931,-5.6476644578956883,-4.8050894439456844,-3.9625144299956796,-3.1199394160456748,-2.27736440209567,-1.4347893881456657,-0.59221437419566159,0.25036063975434386,1.0929356537043491,1.935510667654353,2.7780856816043569,3.6206606955543625,4.4632357095043673,5.3058107234543712,6.148385737404376,6.9909607513543799,7.8335357653043873],[-7.7335896201996253,-6.8910146062496205,-6.0484395922996157,-5.2058645783496118,-4.363289564399607,-3.5207145504496022,-2.6781395364995975,-1.8355645225495931,-0.99298950859958846,-0.15041449464958445,0.692160519300421,1.5347355332504262,2.3773105472004303,3.2198855611504342,4.0624605751004399,4.9050355890504447,5.7476106030004486,6.5901856169504534,7.4327606309004572,8.2753356448504647],[-7.2917897406535479,-6.4492147267035431,-5.6066397127535383,-4.7640646988035344,-3.9214896848535297,-3.0789146709035249,-2.2363396569535201,-1.3937646430035158,-0.5511896290535111,0.2913853848964929,1.1339603988464984,1.9765354127965036,2.8191104267465077,3.6616854406965116,4.5042604546465173,5.346835468596522,6.1894104825465259,7.0319854964965307,7.8745605104465346,8.7171355243965412],[-6.8499898611074705,-6.0074148471574667,-5.164839833207461,-4.3222648192574571,-3.4796898053074528,-2.637114791357448,-1.7945397774074432,-0.95196476345743863,-0.10938974950743396,0.73318526444257004,1.5757602783925755,2.4183352923425807,3.2609103062925846,4.1034853202425889,4.9460603341925946,5.7886353481425985,6.6312103620926024,7.4737853760426081,8.316360389992612,9.1589354039426194],[-6.4081899815613932,-5.5656149676113884,-4.7230399536613836,-3.8804649397113797,-3.0378899257613754,-2.1953149118113706,-1.3527398978613656,-0.51016488391136106,0.33241013003864361,1.1749851439886476,2.0175601579386528,2.8601351718886581,3.702710185838662,4.5452851997886663,5.387860213738672,6.2304352276886767,7.0730102416386806,7.9155852555886854,8.7581602695386884,9.6007352834886959],[-5.9663901020153167,-5.1238150880653119,-4.2812400741153072,-3.4386650601653028,-2.5960900462152985,-1.7535150322652937,-0.91094001831528892,-0.068365004365284338,0.7742100095847203,1.6167850235347243,2.4593600374847298,3.301935051434735,4.1445100653847389,4.9870850793347428,5.8296600932847484,6.6722351072347532,7.5148101211847571,8.3573851351347628,9.1999601490847667,10.042535163034774],[-5.5245902224692403,-4.6820152085192355,-3.8394401945692302,-2.9968651806192259,-2.1542901666692216,-1.3117151527192168,-0.46914013876921212,0.37343487518079244,1.2160098891307971,2.058584903080801,2.9011599170308067,3.7437349309808119,4.5863099449308153,5.4288849588808192,6.2714599728308249,7.1140349867808297,7.9566100007308336,8.7991850146808392,9.6417600286308431,10.484335042580851],[-5.0827903429231629,-4.2402153289731572,-3.3976403150231529,-2.5550653010731486,-1.7124902871231442,-0.86991527317313944,-0.027340259223134655,0.8152347547268699,1.6578097686768745,2.5003847826268784,3.342959796576884,4.1855348105268888,5.0281098244768927,5.8706848384268966,6.7132598523769023,7.5558348663269079,8.3984098802769118,9.2409848942269157,10.08355990817692,10.926134922126927],[-4.6409904633770847,-3.7984154494270799,-2.9558404354770751,-2.1132654215270712,-1.2706904075770666,-0.42811539362706186,0.41445962032294292,1.2570346342729475,2.0996096482229523,2.9421846621729562,3.7847596761229614,4.627334690072967,5.4699097040229709,6.3124847179729748,7.1550597319229805,7.9976347458729853,8.8402097598229883,9.682784773772994,10.525359787722998,11.367934801673005],[-4.1991905838310082,-3.3566155698810034,-2.5140405559309986,-1.6714655419809943,-0.82889052803098995,0.013684485919014833,0.85625949986901961,1.6988345138190242,2.5414095277690287,3.3839845417190331,4.2265595556690378,5.0691345696190435,5.9117095835690474,6.7542845975190513,7.596859611469057,8.4394346254190609,9.2820096393690648,10.12458465331907,10.967159667269074,11.809734681219082],[-3.7573907042849313,-2.9148156903349265,-2.0722406763849217,-1.2296656624349174,-0.38709064848491304,0.45548436546509175,1.2980593794150965,2.1406343933651009,2.9832094073151056,3.8257844212651095,4.6683594352151152,5.51093444916512,6.3535094631151239,7.1960844770651278,8.0386594910151334,8.8812345049651391,9.723809518915143,10.566384532865147,11.408959546815151,12.251534560765158],[-3.3155908247388539,-2.4730158107888491,-1.6304407968388444,-0.78786578288884002,0.054709231061164321,0.8972842450111691,1.7398592589611739,2.5824342729111782,3.425009286861183,4.2675843008111869,5.1101593147611926,5.9527343287111982,6.7953093426612021,7.637884356611206,8.4804593705612117,9.3230343845112156,10.165609398461219,11.008184412411225,11.850759426361229,12.693334440311236],[-2.8737909451927761,-2.0312159312427713,-1.1886409172927666,-0.34606590334276222,0.49650911060724212,1.3390841245572469,2.1816591385072517,3.0242341524572565,3.8668091664072608,4.7093841803572651,5.5519591943072708,6.3945342082572756,7.2371092222072795,8.0796842361572843,8.9222592501072882,9.7648342640572938,10.607409278007298,11.449984291957303,12.292559305907307,13.135134319857315],[-2.4319910656466988,-1.589416051696694,-0.7468410377466892,0.095733976203315141,0.93830899015331948,1.7808840041033243,2.623459018053329,3.4660340320033338,4.3086090459533386,5.1511840599033425,5.9937590738533473,6.8363340878033529,7.6789091017533568,8.5214841157033607,9.3640591296533664,10.20663414360337,11.049209157553374,11.89178417150338,12.734359185453384,13.576934199403391],[-1.9901911861006223,-1.1476161721506175,-0.30504115820061273,0.53753385574939161,1.3801088696993959,2.2226838836494007,3.0652588975994055,3.9078339115494103,4.7504089254994151,5.592983939449419,6.4355589533994237,7.2781339673494294,8.1207089812994333,8.9632839952494372,9.8058590091994429,10.648434023149449,11.491009037099452,12.333584051049456,13.17615906499946,14.018734078949468]],"type":"surface","opacity":0.75,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>En forma similar a la RLS, la interpretación de cada parámetro <span class="math inline">\(\beta\)</span> de la regresión es:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: es el valor esperado de <span class="math inline">\(Y\)</span> cuando todas las otras variables son iguales a cero.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> es la pendiente a lo largo del eje <span class="math inline">\(X_1\)</span> y representa el cambio esperado en la respuesta por unidad de cambio en <span class="math inline">\(X_1\)</span> a valores constantes de <span class="math inline">\(X_2\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> es la pendiente a lo largo del eje <span class="math inline">\(X_2\)</span> y representa el cambio esperado en la respuesta por unidad de cambio en <span class="math inline">\(X_2\)</span> a valores constantes de <span class="math inline">\(X_1\)</span>.</p></li>
</ul></section><section id="presupuestos-del-modelo-de-rlm" class="level2"><h2 class="anchored" data-anchor-id="presupuestos-del-modelo-de-rlm">Presupuestos del modelo de RLM</h2>
<section id="independencia" class="level3"><h3 class="anchored" data-anchor-id="independencia">Independencia</h3>
<p>Las observaciones <span class="math inline">\(Y_i\)</span> son independientes unas de otras: el efecto de <span class="math inline">\(X_1\)</span> sobre la respuesta media no depende de <span class="math inline">\(X_2\)</span> y viceversa, siempre y cuando no exista interacción. Cuando existe interacción entre <span class="math inline">\(X_1\)</span> e <span class="math inline">\(X_2\)</span> , el efecto de <span class="math inline">\(X_1\)</span> sobre la respuesta media de <span class="math inline">\(Y\)</span> depende <span class="math inline">\(X_2\)</span> y viceversa (<span class="math inline">\(X_1\)</span> e <span class="math inline">\(X_2\)</span> no son independientes cuando existe interacción).</p>
</section><section id="linealidad" class="level3"><h3 class="anchored" data-anchor-id="linealidad">Linealidad</h3>
<p>Para cada combinación de valores de las variables independientes (<span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…, <span class="math inline">\(X_k\)</span>) el valor medio de <span class="math inline">\(Y\)</span> es función lineal de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…,<span class="math inline">\(X_k\)</span>.. La linealidad se define en relación a los coeficientes de la regresión, por lo tanto el modelo puede incluir términos cuadráticos e interacciones</p>
<ul>
<li>Modelo con interacción</li>
</ul>
<p><span class="math display">\[
Y = \beta_0X_1 + \beta_2X_2 + \beta_3X_1X_2
\]</span></p>
<ul>
<li>
<p>Modelo con términos cuadráticos</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3X_1^2 + \beta_4X_2^2
\]</span></p>
</li>
</ul></section><section id="homocedasticidad" class="level3"><h3 class="anchored" data-anchor-id="homocedasticidad">Homocedasticidad</h3>
<p>la varianza de <span class="math inline">\(Y\)</span> para los distintos valores de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,…,<span class="math inline">\(X_k\)</span> se mantiene constante.</p>
</section><section id="normalidad" class="level3"><h3 class="anchored" data-anchor-id="normalidad">Normalidad</h3>
<p>Los valores de <span class="math inline">\(Y\)</span> tienen una distribución normal según los valores de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_k\)</span> , ésto nos permite realizar inferencias en relación a los parámetros del modelo.</p>
<p>Al igual que en la RLS la estimación de los parámetros de la regresión (coeficientes) se realiza mediante el <strong>Método de los Mínimos Cuadrados</strong> <strong>(MMC)</strong>. El mismo consiste en adoptar como estimativas de los parámetros de la regresión los valores que minimicen la suma de los cuadrados de los residuos.</p>
<p><span class="math display">\[
\sum_{i=1}^{i=n}e_1^2=\sum_{i=1}^{i=n}(Y_i-\hat{Y_i})^2=\sum_{i=n}^{i=n}(Y_i-(\hat{\beta}_0+\hat{\beta}_1X_1+\dots+\hat{\beta}_kX_k))^2
\]</span></p>
</section></section><section id="interpretación-del-modelo" class="level2"><h2 class="anchored" data-anchor-id="interpretación-del-modelo">Interpretación del modelo</h2>
<p>Comenzaremos aprendiendo cómo interpretar un modelo de regresión lineal múltiple (RLM) antes de abordar su construcción. Para ilustrarlo, observemos en detalle la salida de R para un modelo de RLM en el que modelamos la variable <code>V23</code>, en función de las variables <code>V10</code>, <code>V11</code>, <code>V12</code>, <code>V14</code>, <code>V15</code>, <code>V17</code>, <code>V18</code> y <code>V24</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = V23 ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.45958 -0.57136  0.05354  0.57868  2.25036 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  0.09504    0.09502   1.000   0.3199  
V10         -0.05189    0.09725  -0.534   0.5950  
V11         -0.11508    0.09711  -1.185   0.2391  
V12         -0.08137    0.09151  -0.889   0.3763  
V14         -0.16411    0.09738  -1.685   0.0954 .
V15         -0.03240    0.10283  -0.315   0.7534  
V17         -0.04053    0.09040  -0.448   0.6550  
V18          0.14425    0.09456   1.525   0.1306  
V24         -0.04953    0.08940  -0.554   0.5809  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9081 on 91 degrees of freedom
Multiple R-squared:  0.09027,   Adjusted R-squared:  0.0103 
F-statistic: 1.129 on 8 and 91 DF,  p-value: 0.3518</code></pre>
</div>
</div>
<p>En la salida obtenida, encontramos varios términos clave para interpretar:</p>
<ul>
<li><p><code>Estimate</code>: muestra los coeficientes estimados (<span class="math inline">\(\beta\)</span>) para el intercepto (<span class="math inline">\(\beta_0\)</span>) y para cada una de las variables explicativas (<span class="math inline">\(\beta_i\)</span>).</p></li>
<li><p><code>Std. Error</code>: el error estándar de cada coeficiente estimado <span class="math inline">\(\beta\)</span>.</p></li>
<li><p><code>t-value</code>: los valores del test <span class="math inline">\(t\)</span> para cada coeficiente, que evalúan si los coeficientes son significativamente diferentes de cero.</p></li>
<li><p><code>Pr(&gt;|t|)</code>: los valores <span class="math inline">\(p\)</span> asociados a los test <span class="math inline">\(t\)</span> para cada coeficiente.</p></li>
<li><p><code>Residual standard error</code>: el error estándar de los residuales.</p></li>
<li><p><code>Multiple R-squared</code>: el coeficiente de determinación <span class="math inline">\(R^2\)</span> múltiple, que indica qué proporción de la variabilidad de la variable dependiente es explicada por el modelo.</p></li>
<li><p><code>Adjusted R-squared</code>: el coeficiente de determinación ajustado, que penaliza por la inclusión de variables que no mejoran el modelo.</p></li>
<li><p><code>F-statistic</code>: el resultado del test <span class="math inline">\(F\)</span> global, que evalúa la significancia del modelo en su conjunto, junto con su valor <span class="math inline">\(p\)</span>.</p></li>
</ul>
<section id="test-f-parcial" class="level3"><h3 class="anchored" data-anchor-id="test-f-parcial">Test F parcial</h3>
<p>En un modelo de regresión, la estimación de los coeficientes se realiza partiendo de una muestra, lo que implica que diferentes muestras pueden generar distintos valores de los parámetros. El test F parcial evalúa la siguiente hipótesis:</p>
<p><span class="math display">\[
H_0 = \beta_1 = \beta_2 = ... \beta_n = 0  \\H_1 = \exists\beta_i \neq 0
\]</span></p>
<p>Donde <span class="math inline">\(H_0\)</span> indica que todos los coeficientes de las variables independientes son cero, y <span class="math inline">\(H_1\)</span> implica que al menos uno de los coeficientes es diferente de cero. Este test evalúa la contribución de cada variable al modelo, es decir, si la inclusión de esa variable mejora significativamente la explicación de la variabilidad de <span class="math inline">\(Y\)</span>. En modelos de regresión lineales generalizados (GLM), el test de Wald cumple esta misma función, mientras que en los modelos de regresión lineales múltiplos, el test <span class="math inline">\(F\)</span> parcial cumple el mismo rol.</p>
</section><section id="varianza-residual" class="level3"><h3 class="anchored" data-anchor-id="varianza-residual">Varianza residual</h3>
<p>Al igual que en la <a href="../unidad_3/04_reg_lineal.html"><strong>regresión lineal simple</strong></a>y el <a href="../unidad_3/05_anova.html"><strong>análisis de la varianza (ANOVA)</strong></a>, podemos descomponer la variabilidad de la variable dependiente <span class="math inline">\(Y\)</span> en dos componentes:</p>
<ol type="1">
<li><p>Variabilidad explicada por el modelo.</p></li>
<li><p>Variabilidad <strong>no explicada</strong> por el modelo, atribuida a factores aleatorios.</p></li>
</ol>
<p>Matemáticamente, esto se expresa como:</p>
<p><span class="math display">\[
Variabilidad \ total = Variabilidad \ regresión \ + \ Variabilidad \ residual
\]</span></p>
<p>De manera equivalente, la suma de cuadrados totales (SCT) se descompone en la suma de cuadrados de la regresión (SCR) y la suma de cuadrados residuales (SCE):</p>
<p><span class="math display">\[
\sum (y_i-\bar{y})^2 = \sum (\hat{y}-\bar{y})^2 + \sum (y_i -\hat{y}_i)^2
\\
SCT = SCR + SCE
\]</span></p>
<p>A continuación, mostramos cómo estos términos se distribuyen entre los grados de libertad y se obtienen los cuadrados medios correspondientes:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-condensed table-hover caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;">Grados de libertad</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;">CM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SCT</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: left;">CMT = SCT/n-1</td>
</tr>
<tr class="even">
<td style="text-align: left;">SCR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: left;">CMR = SCR/k-1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SCE</td>
<td style="text-align: left;">n-k-1</td>
<td style="text-align: left;">CME = SCE/n-k-1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="test-f-global" class="level3"><h3 class="anchored" data-anchor-id="test-f-global">Test F global</h3>
<p>El test <span class="math inline">\(F\)</span> global compara el modelo de regresión ajustado con el modelo nulo (sin variables independientes) y evalúa el efecto conjunto de todas las variables independientes. Su fórmula es:</p>
<p><span class="math display">\[
F = CMR/CME
\\
gl = (k -1, n - k - 1)
\]</span></p>
</section><section id="coeficiente-de-determinación" class="level3"><h3 class="anchored" data-anchor-id="coeficiente-de-determinación">Coeficiente de determinación</h3>
<p>Al igual de lo que aprendimos en la RLS la bondad de ajuste del modelo de RLM se valora con el coeficiente de determinación (<span class="math inline">\(R^2\)</span>), que nos dice qué proporción de la variabilidad de <span class="math inline">\(Y\)</span> es explicada por los coeficientes de la regresión del modelo en estudio. Su valor se calcula como:</p>
<p><span class="math display">\[ R^2 = \frac{SCT-SCE}{SCT}=\frac{SCR}{SCT} \]</span></p>
<p>Sin embargo, al agregar más variables al modelo, <span class="math inline">\(R^2\)</span> siempre mejora, incluso si la nueva variable no mejora sustancialmente el modelo. Este fenómeno se debe a que <span class="math inline">\(R^2\)</span> solo refleja la proporción de variabilidad explicada, pero no penaliza la inclusión de variables que no aportan al modelo.</p>
<p>Por esta razón, se utiliza el <span class="math inline">\(R^2\)</span> ajustado, que corrige el <span class="math inline">\(R^2\)</span> penalizando la inclusión de variables que no aportan significativamente:</p>
<p><span class="math display">\[ R^2_a = 1 - \bigg [ \frac{n-1}{n-(k+1)}\bigg]\frac{SCE}{SCT}=1-\bigg[\frac{n-1}{n-(k+1)}\bigg](1-R^2)  \]</span></p>
<p>Como el término <span class="math inline">\(1 - R^2\)</span> es constante y <span class="math inline">\(n\)</span> es mayor que <span class="math inline">\(k\)</span>, a medida que agregamos variables, el cociente entre paréntesis crece, lo que hace que la penalización por agregar variables no significativas también aumente. Esto hace que el <span class="math inline">\(R^2\)</span> ajustado sea una medida más fiable de la calidad del modelo.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Cuando tenemos que elegir el mejor modelo será necesario utilizar distintos criterios para compararlos y basar nuestra decisión en elegir el modelo que mejor explique la variación de <span class="math inline">\(Y\)</span> con el menor número de variables independientes, el modelo más simple y efectivo, también llamado el modelo más <strong>parsimonioso</strong>.</p>
</div>
</div>
</div>
</section></section><section id="variables-dummy" class="level2"><h2 class="anchored" data-anchor-id="variables-dummy">Variables <em>dummy</em>
</h2>
<p>En los modelos de regresión, podemos incluir tanto variables cuantitativas como variables categóricas. Las variables categóricas pueden ser dicotómicas (por ejemplo, sexo: femenino/masculino; hábito de fumar: sí/no) o tener más de dos categorías (por ejemplo, grupo sanguíneo, religión, color de ojos).</p>
<p>Para modelar las variables categóricas, cada categoría se transforma en una variable dicotómica (binaria), con un número de categorías menos uno. Es decir, para una variable con <span class="math inline">\(n\)</span> categorías, se crearán <span class="math inline">\(n-1\)</span> variables <em>dummy</em>, donde <span class="math inline">\(1\)</span> indica la presencia de esa categoría y <span class="math inline">\(0\)</span> indica su ausencia. En estos casos, se selecciona como grupo basal (o grupo de referencia) la categoría con el valor más bajo.</p>
<section id="ejemplo-para-variable-independiente-dicotómica" class="level4"><h4 class="anchored" data-anchor-id="ejemplo-para-variable-independiente-dicotómica">Ejemplo para variable independiente dicotómica</h4>
<p>Supongamos que tenemos una variable cualitativa dicotómica, como “Hábito de Fumar”, que toma los valores 1 (si fuma) y 0 (si no fuma). Si ajustamos un modelo con esta variable, la ecuación sería:</p>
<p><span class="math display">\[
Y = \beta_0+\beta_1F_1  
\]</span></p>
<p>Donde:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> es la variable dependiente.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> es el intercepto (valor basal de <span class="math inline">\(Y\)</span> cuando el individuo no fuma).</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> es el coeficiente asociado al hábito de fumar, que indica el cambio en <span class="math inline">\(Y\)</span> cuando el individuo fuma (es decir, la diferencia entre el grupo de fumadores y no fumadores).</p></li>
</ul></section><section id="ejemplo-para-variable-independiente-con-múltiples-categorías" class="level4"><h4 class="anchored" data-anchor-id="ejemplo-para-variable-independiente-con-múltiples-categorías">Ejemplo para variable independiente con múltiples categorías</h4>
<p>Ahora, consideremos una variable “Región”, que tiene tres categorías: Noreste (NE), Norte (N) y Centro Oeste (CO). Para modelarla como variables <em>dummy</em>, la transformamos en dos variables: <span class="math inline">\(Re_1\)</span> y <span class="math inline">\(Re_2\)</span>, ya que hay <span class="math inline">\(n-1 = 3-1 = 2\)</span> categorías <em>dummy</em>.</p>
<p>La transformación de las categorías sería:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-condensed table-hover caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;">Región</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;">RE1</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF; color: white !important; background-color: rgba(47, 46, 78, 255) !important;">RE2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NE (basal)</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">N</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>En este caso:</p>
<ul>
<li><p><span class="math inline">\(Re_1 = 1\)</span> si vive en el Norte, <span class="math inline">\(Re_1 = 0\)</span> si vive en otra región.</p></li>
<li><p><span class="math inline">\(Re_2 = 1\)</span> si vive en el Centro Oeste, <span class="math inline">\(Re_2 = 0\)</span> si vive en otra región.</p></li>
</ul>
<p>Ahora imaginemos el modelo de regresión entre <span class="math inline">\(Y\)</span> y la variable <em>“región”</em> (supongamos que <span class="math inline">\(Y\)</span> es la Tasa de Mortalidad Infantil):</p>
<p><span class="math display">\[
Y = \beta_0+\beta_1Re_1 + \beta_2Re_2
\]</span></p>
<p>Para interpretar el modelo:</p>
<ul>
<li>Si el individuo vive en la región Norte (<span class="math inline">\(Re_1 = 1\)</span> y <span class="math inline">\(Re_2 = 0\)</span>), la ecuación se reduce a:</li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1Re_1  
\]</span></p>
<ul>
<li>Si el individuo vive en la región Centro Oeste (<span class="math inline">\(Re_1 = 0\)</span> y <span class="math inline">\(Re_2 = 1\)</span>), la ecuación sería:</li>
</ul>
<p><span class="math display">\[ Y=\beta_0+\beta_2Re_2  \]</span></p>
<ul>
<li>Si el individuo vive en la región Noreste (grupo basal, <span class="math inline">\(Re_1 = 0\)</span> y <span class="math inline">\(Re_2 = 0\)</span>), la ecuación se reduce a:</li>
</ul>
<p><span class="math display">\[ Y=\beta_0 \]</span></p>
<p>En este contexto, <span class="math inline">\(\beta_1\)</span> y <span class="math inline">\(\beta_2\)</span> nos estarán indicando cuánto se modifica la TMI según consideremos la región Norte o Centro Oeste. El coeficiente <span class="math inline">\(\beta_0\)</span> es el valor basal medio de la TMI considerada en la región Noreste</p>
<p>Las variables <em>dummy</em> o indicadoras no tienen un significado por sí solas, ya que su interpretación depende de cómo se comparan con el grupo basal. Es importante que todas las categorías de la variable cualitativa estén representadas en el modelo, y la inclusión de estas variables debe ser contrastada en bloque, incluso si algunos de los tests <span class="math inline">\(F\)</span> parciales para una categoría no son significativos.</p>
<p>Además, al agregar una variable <em>dummy</em> al modelo, esta incrementa los grados de libertad de la regresión en función de la cantidad de categorías de la variable. Por ejemplo, si una variable tiene <span class="math inline">\(n\)</span> categorías, se agregarán <span class="math inline">\(n-1\)</span> variables <em>dummy</em>, cada una con su respectivo grado de libertad.</p>
<p>Cuando trabajamos en R, el lenguaje se encarga de construir las variables <em>dummy</em> automáticamente siempre que su estructura sea <strong>factor</strong>. Los tipos de datos <strong>factor</strong> tienen una estructura de niveles donde el primero de ellos es el de referencia. Para modificar el nivel de referencia podemos utilizar las funciones <code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code> de R <code>base</code> o <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> de <code>tidyverse</code>.</p>
</section></section><section id="estimación-y-predicción-en-modelos-de-regresión" class="level2"><h2 class="anchored" data-anchor-id="estimación-y-predicción-en-modelos-de-regresión">Estimación y predicción en modelos de regresión</h2>
<p>La regresión es una herramienta clave en los análisis tanto explicativos como predictivos, y se utiliza de las siguientes maneras:</p>
<ol type="1">
<li><p><strong>Con fines explicativos</strong>: Este uso tiene como objetivo obtener estimaciones precisas sobre variables de interés para realizar inferencias o cuantificar relaciones entre variables, controlando por otras. Aquí se busca entender cómo los cambios en las variables independientes afectan a la variable dependiente.</p></li>
<li><p><strong>Con fines predictivos</strong>: La regresión también se utiliza para predecir el comportamiento de la variable dependiente (<span class="math inline">\(Y\)</span>) basándose en los valores de las variables independientes (<span class="math inline">\(X_k\)</span>) observados en la muestra. Sin embargo, la predicción solo debe hacerse si existe una correlación lineal adecuada y si el modelo ajustado es adecuado para los datos.</p></li>
</ol>
<section id="consideraciones-para-la-predicción" class="level4"><h4 class="anchored" data-anchor-id="consideraciones-para-la-predicción">Consideraciones para la predicción:</h4>
<ul>
<li><p><strong>No utilizar el modelo si no hay correlación lineal</strong>: Si no existe una correlación lineal significativa entre <span class="math inline">\(Y\)</span> y las <span class="math inline">\(X_k\)</span>, la predicción no será válida. En estos casos, la mejor predicción es la media muestral de <span class="math inline">\(Y\)</span>.</p></li>
<li><p><strong>No extrapolar más allá de los valores muestrales conocidos</strong>: Las predicciones fuera del rango de los datos observados pueden ser inexactas.</p></li>
<li><p><strong>Datos actualizados</strong>: La predicción debe basarse en datos recientes y relevantes.</p></li>
<li><p><strong>No predecir para poblaciones distintas</strong>: El modelo debe ser usado solo para hacer predicciones dentro de la población de la cual se obtuvieron los datos muestrales.</p></li>
<li><p><strong>Relación no necesariamente causal para modelos predictivos</strong>: Mientras que para modelos explicativos la relación entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> debe ser causal (en términos temporales y lógicos), para la predicción basta con que exista una correlación.</p></li>
</ul></section></section><section id="lineamientos-la-selección-del-modelo-de-regresión" class="level2"><h2 class="anchored" data-anchor-id="lineamientos-la-selección-del-modelo-de-regresión">Lineamientos la selección del modelo de regresión</h2>
<p>Dada una variable dependiente <span class="math inline">\(Y\)</span> y un conjunto de <span class="math inline">\(k\)</span> variables independientes <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>….,<span class="math inline">\(X_k\)</span> , nuestro interés es definir el mejor conjunto de <span class="math inline">\(p\)</span> predictores (<span class="math inline">\(p \leq k\)</span>) y el correspondiente modelo de regresión para describir la relación entre <span class="math inline">\(Y\)</span> y las variables <span class="math inline">\(X\)</span>.</p>
<p>Para ello, debemos seguir los siguientes pasos:</p>
<ol type="1">
<li>Especificar el conjunto de variables potencialmente predictivas/explicativas</li>
<li>Evaluar colinealidad</li>
<li>Especificar un criterio estadístico para la elección de las variables</li>
<li>Especificar una estrategia para seleccionar modelos</li>
<li>Conducir el análisis específico</li>
<li>Evaluar los presupuestos del modelo</li>
<li>Evaluar la confiabilidad del modelo escogido</li>
</ol>
<section id="identificación-de-variables-potencialmente-predictivasexplicativas" class="level3"><h3 class="anchored" data-anchor-id="identificación-de-variables-potencialmente-predictivasexplicativas">Identificación de variables potencialmente predictivas/explicativas</h3>
<p>El primer paso para construir un modelo de regresión es seleccionar un conjunto adecuado de variables predictivas. Esto implica identificar aquellas variables que mejor expliquen la variable dependiente sin que ninguna de ellas sea combinación lineal de las restantes.</p>
<p>El primer paso a seguir es identificar las relaciones entre la variable dependiente y las variables independientes de forma bivariada utilizando tests de correlación y gráficos de dispersión para las variables explicativas continuas y tests de asociación para las variables explicativas categóricas.</p>
</section><section id="colinealidad" class="level3"><h3 class="anchored" data-anchor-id="colinealidad">Colinealidad</h3>
<p>Un problema frecuente en los modelos de RLM es el de la <strong>multicolinealidad</strong>, que ocurre cuando las variables independientes están relacionadas entre sí en forma lineal. Si bien no implica una violación de las hipótesis o presupuestos del modelo, puede ocasionar problemas en la inferencia, ya que:</p>
<ul>
<li><p>Aumenta las varianzas y covarianzas de los estimadores.</p></li>
<li><p>Los errores de las estimaciones serán grandes.</p></li>
<li><p>Tiende a producir estimadores con valores absolutos grandes.</p></li>
<li><p>Los coeficientes de cada variable independiente difieren notablemente de los que se obtendrían por RLS.</p></li>
<li><p>No se puede identificar de forma precisa el efecto individual de cada variable colineal sobre la variable respuesta.</p></li>
</ul>
<p>A la hora de plantear modelos de RLM conviene estudiar previamente la existencia de casi-colinealidad (la colinealidad exacta no es necesario estudiarla previamente, ya que todos los algoritmos la detectan, de hecho no pueden acabar la estimación). Como medida de la misma hay varios estadísticos propuestos:</p>
<ul>
<li><p>Podemos examinar la matriz de correlación</p></li>
<li><p>Realizar gráficos de dispersión entre las variables explicativas/predictivas</p></li>
<li><p>Cálculo del factor de inflación de la varianza (VIF por sus siglas en inglés):</p></li>
</ul>
<p><span class="math display">\[
VIF = \frac{1}{1-R^2_i}
\]</span></p>
<p>Una regla empírica, citada por <span class="citation" data-cites="kleinbaum1988">Kleinbaum et&nbsp;al. (<a href="#ref-kleinbaum1988" role="doc-biblioref">1988</a>)</span>, consiste en considerar que existen problemas de colinealidad si algún VIF es superior a 10. Por otro lado <span class="citation" data-cites="kim2019">Kim (<a href="#ref-kim2019" role="doc-biblioref">2019</a>)</span> considera que un VIF entre 5 y 10 indican la presencia de colinealidad. En caso de detectar colinealidad entre dos predictores, existen dos posibles soluciones:</p>
<ul>
<li><p>Excluir uno de los predictores problemáticos intentando conservar el que, a juicio del investigador, está influyendo realmente en la variable respuesta</p></li>
<li><p>Combinar las variables colineales en un único predictor, aunque con el riesgo de perder su interpretación</p></li>
</ul></section><section id="selección-de-variables" class="level3"><h3 class="anchored" data-anchor-id="selección-de-variables">Selección de variables</h3>
<p>Generalmente incluiremos en el modelo aquellas variables que resultaron significativas en el análisis bivariado y otras que, aun cuando no resultaran significativas, decidamos mantener por cuestiones teóricas, porque se necesitan establecer predicciones para distintas categorías de dicha variable, etc.</p>
<p>El proceso de selección de variables puede realizarse en forma manual o automática, siendo este último desaconsejado por la mayoría de los autores, ya que en el proceso de ajuste de un modelo no sólo se involucran criterios estadísticos sino también conceptuales. Existen tres estrategias para realizar el proceso , basadas en el valor del test <span class="math inline">\(F\)</span> parcial:</p>
<ul>
<li><p><strong>Método jerárquico o <em>forward:</em></strong> se basa en el criterio del investigador que introduce predictores determinados en un orden específico en relación al marco teórico. Comienza con un modelo nulo que solo contiene el intercepto (<span class="math inline">\(\beta_0\)</span>) y agrega secuencialmente una variable a la vez, eligiendo la que proporciona el mayor beneficio en términos de ajuste del modelo. Este proceso continúa hasta que agregar más variables no mejore significativamente el ajuste del modelo.</p></li>
<li><p><strong>Método de entrada forzada o <em>backward</em></strong>: es el método inverso al anterior. Se introducen todos los predictores simultáneamente y, en cada paso, elimina la variable que tenga el menor impacto en el ajuste del modelo. Este proceso continúa hasta que eliminar más variables no mejore significativamente el ajuste del modelo. Permite evaluar cada variable en presencia de las otras.</p></li>
<li><p><strong>Método paso a paso o <em>stepwise</em></strong>: emplea criterios matemáticos para decidir qué predictores contribuyen significativamente al modelo y en qué orden se introducen. Se trata de una combinación de la selección <em>forward</em> y <em>backward.</em> Comienza con un modelo nulo, pero tras cada nueva incorporación se realiza un test de extracción de predictores no útiles como en el <em>backward.</em> Presenta la ventaja de que si a medida que se añaden predictores, alguno de los ya presentes deja de contribuir al modelo, se elimina.</p></li>
</ul></section><section id="selección-de-modelos" class="level3"><h3 class="anchored" data-anchor-id="selección-de-modelos">Selección de modelos</h3>
<p>Hasta ahora hemos desarrollado algunos criterios que se pueden utilizar para comparar modelos como <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado y <span class="math inline">\(F\)</span> global. Como hemos mencionado anteriormente el uso de <span class="math inline">\(R^2\)</span> como único criterio de selección tiene varias desventajas: tiende a sobreestimar, al adicionar variables siempre aumenta, por lo que si fuera el único criterio elegiría modelos con el mayor número de variables, no tiene en consideración la relación entre parámetros y tamaño muestral.</p>
<p>Para modelos anidados, podemos realizar una comparación entre ambos modelos mediante un ANOVA. Existen otros criterios como el Criterio de Información de Akaike (<strong>AIC</strong>), el Criterio de Información Bayesiano (<strong>BIC</strong>), etc. Tanto el BIC como el AIC, son funciones del logaritmo de la verosimilitud y un término de penalidad basado en el número de parámetros del modelo.</p>
<p>Recuerden que frente a <span class="math inline">\(p\)</span> variables independientes existen <span class="math inline">\(2^p\)</span> posibles modelos. No necesariamente el modelo con mayor número de variables es el mejor. Debemos priorizar siempre el principio de parsimonia (el modelo más simple que mejor explique). El tamaño de la muestra también es importante, algunos autores recomiendan que el número de observaciones sea como mínimo entre 10 y 20 veces el número de predictores del modelo.</p>
</section></section><section id="validación-y-diagnóstico-del-modelo" class="level2"><h2 class="anchored" data-anchor-id="validación-y-diagnóstico-del-modelo">Validación y diagnóstico del modelo</h2>
<p>Utilizaremos el análisis de los residuales para realizar los contrastes <em>a posteriori</em> de las hipótesis del modelo. Recordemos que los residuos o residuales se definen como la diferencia entre el valor observado y el valor predicho por el modelo.</p>
<p><span class="math display">\[
y-\hat{y}=e~(residuo~ o ~error~ residual)
\]</span></p>
<p>El planteamiento habitual es considerar que, como dijimos inicialmente, los valores de <span class="math inline">\(Y\)</span> tienen una distribución normal según los valores de <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>,… <span class="math inline">\(X_k\)</span>., entonces, los residuos también tendrán una distribución normal. Los residuos tienen unidades de medida y, por tanto no se puede determinar si es grande o pequeño a simple vista. Para solucionar este problema se define el residuo estandarizado como el cociente entre el residuo y su desvío estandar. Se considera que un residuo tiene un valor alto, y por lo tanto puede influir negativamente en el análisis, si su residuo estandarizado es mayor a 3 en valor absoluto. También se trabaja con los residuos tipificados o con los residuos estudentizados.</p>
<section id="normalidad-1" class="level3"><h3 class="anchored" data-anchor-id="normalidad-1">Normalidad</h3>
<p>El análisis de normalidad de los residuos lo realizaremos gráficamente (Histograma y gráfico de probabilidad normal) y analíticamente (Contraste de Kolmogorov-Smirnov) o similar.</p>
</section><section id="homocedasticidad-y-linealidad" class="level3"><h3 class="anchored" data-anchor-id="homocedasticidad-y-linealidad">Homocedasticidad y linealidad</h3>
<p>La hipótesis de homocedasticidad establece que la variabilidad de los residuos es independiente de las variables explicativas. En general, la variabilidad de los residuos estará en función de las variables explicativas, pero como las variables explicativas están fuertemente correlacionadas con la variable dependiente, bastara con examinar el gráfico de valores pronosticados versus residuos (a veces residuos al cuadrado).</p>
<p>Comprobamos la hipótesis de homogeneidad de las varianzas gráficamente representando los residuos tipificados frente a los valores predichos por el modelo. El análisis de este gráfico puede revelar una posible violación de la hipótesis de homocedasticidad, por ejemplo si detectamos que el tamaño de los residuos aumenta o disminuye de forma sistemática para algunos valores ajustados de la variable <span class="math inline">\(Y\)</span>, si observamos que el gráfico muestra forma de embudo. Si por el contrario dicho gráfico no muestra patrón alguno, entonces no podemos rechazar la hipótesis de igualdad de varianzas.</p>
</section><section id="valores-de-influencia-leverage" class="level3"><h3 class="anchored" data-anchor-id="valores-de-influencia-leverage">Valores de influencia (<em>leverage</em>)</h3>
<p>Se considera que una observación es influyente <em>a priori</em> si su inclusión en el análisis modifica sustancialmente el sentido del mismo. Una observación puede ser influyente si es un <em>outlier</em> respecto a alguna de las variables explicativas. Para detectar estos problemas se utiliza la medida de <strong>Leverage</strong>:</p>
<p><span class="math display">\[
l(i)=\frac{1}{n}\bigg(1+\frac{(x_i-\bar{x})^2}{S^2_x}\bigg)  
\]</span></p>
<p>Este estadístico mide la distancia de un punto a la media de la distribución. Valores cercanos a 2/<span class="math inline">\(n\)</span> indican casos que pueden influir negativamente en la estimación del modelo introduciendo un fuerte sesgo en el valor de los estimadores.</p>
</section><section id="distancia-de-cook" class="level3"><h3 class="anchored" data-anchor-id="distancia-de-cook">Distancia de Cook</h3>
<p>Es una medida de cómo influye la observación <span class="math inline">\(i\)</span>-ésima sobre la estimación de <span class="math inline">\(\beta\)</span> al ser retirada del conjunto de datos. Una distancia de Cook grande significa que una observación tiene un peso grande en la estimación de <span class="math inline">\(\beta\)</span>. Son puntos influyentes las observaciones que presenten</p>
<p><span class="math display">\[ D_i=\frac{4}{n-p-2}  \]</span></p>
</section><section id="independencia-de-residuos" class="level3"><h3 class="anchored" data-anchor-id="independencia-de-residuos">Independencia de residuos</h3>
<p>La hipótesis de independencia de los residuos la realizaremos mediante el contraste de <em>Durbin-Watson</em>.</p>
</section></section><section id="ejemplo-práctico-en-r" class="level2"><h2 class="anchored" data-anchor-id="ejemplo-práctico-en-r">Ejemplo práctico en R</h2>
<p>En el documento <a href="../unidad_3/02_mod_estadistico.html"><strong>Introducción al modelado estadístico</strong></a> vimos como generar en R una fórmula para un modelo lineal simple:</p>
<p><span class="math display">\[ variable \ dependiente \; \sim variable  \ independiente \]</span></p>
<p>Para generar fórmulas que contengan más de una variable independiente o predictora (necesario para que sea una regresión lineal múltiple) debemos agregarlas mediante el símbolo <span class="math inline">\(+\)</span></p>
<p><span class="math display">\[ variable \ dependiente \ \sim var\_indepen\_1 \ + \ var\_indepen\_2 \ + \; \dots \ + \ var\_indepen\_n \]</span></p>
<p>Si luego de la <code>~</code> incluímos <strong>un punto</strong> como notación de “todas”, estamos creando un <em>modelo saturado</em> con todas las variables incluidas dentro del <em>dataframe</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto es útil cuando tenemos muchas posibles variables explicativas y queremos conocer cuáles tienen una correlación significativa.</p>
<p>También se puede descartar alguna o algunas variables explicativas en particular basado en la misma estructura, mediante el símbolo <span class="math inline">\(-\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span><span class="op">-</span><span class="va">x2</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la línea anterior, incluimos dentro del modelo a todas las variables de <code>data</code> menos <code>x2</code>.</p>
<p>Usaremos para el ejemplo el dataset “<code>cancer_USA.txt</code>”, que contiene información sobre la tasa de mortalidad por cáncer cada 100.000 habitantes de distintos condados de Estados Unidos.</p>
<section id="lectura-de-datos-y-visualización-de-estructura" class="level3"><h3 class="anchored" data-anchor-id="lectura-de-datos-y-visualización-de-estructura">Lectura de datos y visualización de estructura</h3>
<p>Para comenzar, cargamos los paquetes de R necesarios para el análisis:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correlogramaas </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># chequeo de supuestos y análisis de residuales  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/">easystats</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gvlma</span><span class="op">)</span>  </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span>   </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># manejo de datos  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>      </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación leemos los datos y realizamos una exploración rápida</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Carga datos</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span><span class="op">(</span><span class="st">"datos/cancer_USA.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Explora datos</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 213
Columns: 10
$ condado            &lt;chr&gt; "Belknap County", "Carroll County", "Cheshire Count…
$ estado             &lt;chr&gt; "New Hampshire", "New Hampshire", "New Hampshire", …
$ tasa_mortalidad    &lt;dbl&gt; 182.6, 168.8, 162.8, 181.6, 155.0, 163.2, 173.1, 17…
$ mediana_edad       &lt;dbl&gt; 46.1, 50.3, 42.0, 48.1, 41.9, 40.1, 42.6, 43.5, 37.…
$ mediana_edad_cat   &lt;chr&gt; "45+ años", "45+ años", "36-39 años", "45+ años", "…
$ mediana_ingresos   &lt;dbl&gt; 59831, 57556, 56008, 42491, 56353, 71233, 62429, 79…
$ pct_pobreza        &lt;dbl&gt; 10.0, 10.7, 11.8, 14.9, 11.6, 8.7, 9.5, 6.1, 11.8, …
$ pct_salud_publica  &lt;dbl&gt; 16.8, 13.4, 12.7, 22.5, 14.0, 12.7, 13.1, 9.0, 12.4…
$ pct_sec_incompleta &lt;dbl&gt; 15.4, 14.8, 6.1, 13.2, 6.6, 12.9, 10.9, 13.5, 6.1, …
$ pct_desempleo      &lt;dbl&gt; 5.3, 5.8, 6.1, 6.9, 5.0, 5.9, 5.2, 5.6, 6.5, 5.8, 1…</code></pre>
</div>
</div>
<p>La base de datos tiene 100 observaciones y 9 variables. La variable dependiente es <code>tasa_mortalidad</code> y hay 3 variables independientes categóricas y 6 variables independientes numéricas o continuas.</p>
</section><section id="análisis-de-variables-potencialmente-explicativas" class="level3"><h3 class="anchored" data-anchor-id="análisis-de-variables-potencialmente-explicativas">Análisis de variables potencialmente explicativas</h3>
<p>Analizaremos la relación entre las variables explicativas numéricas y la variable dependiente mediante un correlograma con el paquete <code>GGally</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">datos</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># selecciono variables numéricas</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="co"># correlograma</span></span>
<span>  <span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggcorr.html">ggcorr</a></span><span class="op">(</span>label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_reg_lineal_multiple_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como habíamos observado en el capítulo sobre <a href="../unidad_3/03_covarianza_correlacion.html"><strong>covarianza y correlación</strong></a>, la <code>tasa_mortalidad</code> tiene correlación negativa moderada con <code>mediana_ingresos</code>, también que existe una correlación negativa fuerte entre <code>pct_pobreza</code> y <code>mediana_ingresos</code> y moderada con <code>pct_salud_publica</code>.</p>
</section><section id="estrategia-de-construcción-del-modelo" class="level3"><h3 class="anchored" data-anchor-id="estrategia-de-construcción-del-modelo">Estrategia de construcción del modelo</h3>
<p>Al momento de seleccionar las variables independientes que formarán parte del modelo, una de las herramientas más utilizadas es el Criterio de Información de Akaike (AIC) que ajusta mediante <em>máxima verosimilitud</em>. Al penalizar la complejidad excesiva, el AIC ayuda a prevenir el sobreajuste y favorece la inclusión de variables relevantes buscando el modelo equilibrado que describa adecuadamente la relación y tenga el mínimo AIC. Podemos consultar el AIC de un modelo en R mediante la función <code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code>.</p>
<p>Como vimos anteriormente, la selección de variables se puede hacer mediante métodos <em>forward</em>, <em>backward</em> o <em>stepwise</em>. La función <code><a href="https://rdrr.io/r/stats/step.html">step()</a></code> de R <code>base</code> permite encontrar de forma automática el mejor modelo basado en AIC utilizando cualquiera de las 3 variantes del método paso a paso. Por otro lado, la función <code><a href="https://rdrr.io/r/stats/add1.html">drop1()</a></code> de <code>R base</code> nos permite realizar un proceso <em>backward</em> manual, eligiendo que variable quitar del modelo en cada caso según su contribución al AIC. Siempre es oportuno aclarar que estos últimos métodos se basan en cálculos matemático/estadísticos que no tienen en cuenta criterios conceptuales epidemiológicos que surjan del marco teórico, por lo que exigen un control especial del analista.</p>
<p>el lenguaje R ofrece una variedad de funciones para abordar y facilitar la tarea de seleccionar el mejor modelo de regresión (más parsimonioso). Como existe correlación fuerte entre <code>mediana_ingresos</code>, <code>pct_pobreza</code> y <code>pct_salud_publica</code> sólo usaremos la que presente mayor correlación con <code>tasa_mortalidad</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modelo saturado</span></span>
<span><span class="va">mod_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">mediana_ingresos</span> <span class="op">+</span> <span class="va">mediana_edad</span> <span class="op">+</span></span>
<span>             <span class="va">pct_sec_incompleta</span> <span class="op">+</span> <span class="va">pct_desempleo</span> <span class="op">+</span> <span class="va">estado</span>,</span>
<span>           data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mediana ingresos</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">mediana_ingresos</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mediana edad</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">mediana_edad</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Secundaria incompleta</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">pct_sec_incompleta</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Desempleo</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">pct_desempleo</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estado</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">tasa_mortalidad</span> <span class="op">~</span> <span class="va">estado</span>, data <span class="op">=</span> <span class="va">datos</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mediante <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> observamos sus resultados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modelo saturado</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_ingresos + mediana_edad + 
    pct_sec_incompleta + pct_desempleo + estado, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-31.475  -7.254   1.161   7.192  29.261 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.488e+02  1.487e+01  10.006  &lt; 2e-16 ***
mediana_ingresos    -3.810e-04  8.165e-05  -4.666 5.62e-06 ***
mediana_edad         5.005e-01  2.588e-01   1.934  0.05453 .  
pct_sec_incompleta   1.652e-01  1.945e-01   0.849  0.39681    
pct_desempleo        1.643e+00  5.781e-01   2.842  0.00494 ** 
estadoMaine          1.462e+01  5.662e+00   2.582  0.01054 *  
estadoMassachusetts  6.389e+00  5.344e+00   1.196  0.23328    
estadoNew Hampshire  1.166e+01  5.963e+00   1.955  0.05198 .  
estadoNew Jersey     1.020e+01  5.010e+00   2.036  0.04302 *  
estadoNew York       7.909e+00  4.706e+00   1.680  0.09443 .  
estadoPennsylvania   9.905e+00  4.867e+00   2.035  0.04315 *  
estadoRhode Island   5.131e+00  7.359e+00   0.697  0.48646    
estadoVermont        1.325e+01  5.814e+00   2.278  0.02377 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.93 on 200 degrees of freedom
Multiple R-squared:  0.3373,    Adjusted R-squared:  0.2975 
F-statistic: 8.483 on 12 and 200 DF,  p-value: 6.303e-13</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modelos simples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_ingresos, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.040  -8.210   1.093   7.637  35.932 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       2.014e+02  3.521e+00  57.200  &lt; 2e-16 ***
mediana_ingresos -5.200e-04  6.133e-05  -8.479 3.94e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.32 on 211 degrees of freedom
Multiple R-squared:  0.2542,    Adjusted R-squared:  0.2506 
F-statistic:  71.9 on 1 and 211 DF,  p-value: 3.938e-15</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_edad, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-31.870  -9.631   0.512   9.539  46.770 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  134.7306    10.9761  12.275  &lt; 2e-16 ***
mediana_edad   0.8961     0.2600   3.447 0.000684 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.88 on 211 degrees of freedom
Multiple R-squared:  0.05332,   Adjusted R-squared:  0.04883 
F-statistic: 11.88 on 1 and 211 DF,  p-value: 0.0006835</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ pct_sec_incompleta, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.903  -9.319   1.485   9.185  41.404 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        162.9089     2.8037  58.106  &lt; 2e-16 ***
pct_sec_incompleta   0.7202     0.1997   3.607 0.000387 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.84 on 211 degrees of freedom
Multiple R-squared:  0.05808,   Adjusted R-squared:  0.05362 
F-statistic: 13.01 on 1 and 211 DF,  p-value: 0.0003867</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ pct_desempleo, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.594  -8.948   0.508   9.029  40.157 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   158.9950     4.1741  38.091  &lt; 2e-16 ***
pct_desempleo   1.7906     0.5418   3.305  0.00112 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.91 on 211 degrees of freedom
Multiple R-squared:  0.04922,   Adjusted R-squared:  0.04471 
F-statistic: 10.92 on 1 and 211 DF,  p-value: 0.001117</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ estado, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.840  -9.533   0.360   9.100  36.641 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          157.713      4.785  32.960  &lt; 2e-16 ***
estadoMaine           25.438      5.860   4.341 2.24e-05 ***
estadoMassachusetts    7.087      5.998   1.182 0.238741    
estadoNew Hampshire   13.167      6.420   2.051 0.041533 *  
estadoNew Jersey      10.921      5.623   1.942 0.053491 .  
estadoNew York        13.928      5.084   2.739 0.006700 ** 
estadoPennsylvania    17.347      5.075   3.418 0.000762 ***
estadoRhode Island     8.263      8.288   0.997 0.319968    
estadoVermont         18.559      5.998   3.094 0.002251 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.53 on 204 degrees of freedom
Multiple R-squared:  0.1297,    Adjusted R-squared:  0.09555 
F-statistic:   3.8 on 8 and 204 DF,  p-value: 0.0003514</code></pre>
</div>
</div>
<p>En los resúmenes observamos que todos los coeficientes de las variables involucradas son significativas y que los valores mostrados tienen forma de lista, es decir no son tablas “ordenadas”, por lo que muchas veces cuando trabajamos con numerosas variables, se hace difícil la comparación de resultados.</p>
</section><section id="comparación-de-modelos" class="level3"><h3 class="anchored" data-anchor-id="comparación-de-modelos">Comparación de modelos</h3>
<p>El comando <code>compare_performance()</code> del paquete <code>performance</code> permite comparar de manera sencilla entre modelos anidados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare_performance</span><span class="op">(</span><span class="va">mod_full</span>,</span>
<span>                    <span class="va">mod1</span>, <span class="va">mod2</span>, <span class="va">mod3</span>, <span class="va">mod4</span>, <span class="va">mod5</span>,</span>
<span>                    metrics <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     | Model |  AIC (weights) |  BIC (weights) |    R2 | R2 (adj.) |   RMSE
-------------------------------------------------------------------------------
mod_full |    lm | 1675.0 (0.830) | 1722.1 (&lt;.001) | 0.337 |     0.298 | 11.557
mod1     |    lm | 1678.2 (0.170) | 1688.3 (&gt;.999) | 0.254 |     0.251 | 12.261
mod2     |    lm | 1729.0 (&lt;.001) | 1739.1 (&lt;.001) | 0.053 |     0.049 | 13.814
mod3     |    lm | 1727.9 (&lt;.001) | 1738.0 (&lt;.001) | 0.058 |     0.054 | 13.779
mod4     |    lm | 1729.9 (&lt;.001) | 1740.0 (&lt;.001) | 0.049 |     0.045 | 13.844
mod5     |    lm | 1725.1 (&lt;.001) | 1758.7 (&lt;.001) | 0.130 |     0.096 | 13.245</code></pre>
</div>
</div>
<p>Las métricas comunes extraídas de los objetos de regresión, presentadas en una tabla, son:</p>
<ul>
<li><p><code>AIC</code>: Criterio de información de Akaike</p></li>
<li><p><code>BIC</code>: Criterio de información bayesiano</p></li>
<li><p><code>R2</code>: Coeficiente de determinación <span class="math inline">\(R^2\)</span></p></li>
<li><p><code>R2 (adj.)</code>: Coeficiente de determinación ajustado</p></li>
<li><p><code>RMSE:</code> Error cuadrático medio</p></li>
</ul>
<p>También podemos ordenar los modelos de mejor a peor con el argumento <code>rank = TRUE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare_performance</span><span class="op">(</span><span class="va">mod_full</span>,</span>
<span>                    <span class="va">mod1</span>, <span class="va">mod2</span>, <span class="va">mod3</span>, <span class="va">mod4</span>, <span class="va">mod5</span>,</span>
<span>                    metrics <span class="op">=</span> <span class="st">"common"</span>,</span>
<span>                    rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     | Model |    R2 | R2 (adj.) |   RMSE | AIC weights | BIC weights | Performance-Score
---------------------------------------------------------------------------------------------
mod_full |    lm | 0.337 |     0.298 | 11.557 |       0.830 |    4.58e-08 |            80.00%
mod1     |    lm | 0.254 |     0.251 | 12.261 |       0.170 |       1.000 |            68.44%
mod5     |    lm | 0.130 |     0.096 | 13.245 |    1.12e-11 |    5.15e-16 |            14.85%
mod3     |    lm | 0.058 |     0.054 | 13.779 |    2.71e-12 |    1.60e-11 |             1.89%
mod2     |    lm | 0.053 |     0.049 | 13.814 |    1.59e-12 |    9.36e-12 |             0.87%
mod4     |    lm | 0.049 |     0.045 | 13.844 |    1.00e-12 |    5.90e-12 |         1.18e-10%</code></pre>
</div>
</div>
<p>Podemos ver que el modelo saturado tiene un menor AIC y <em>performance</em> global que los modelos univariados.</p>
</section><section id="colinealidad-1" class="level3"><h3 class="anchored" data-anchor-id="colinealidad-1">Colinealidad</h3>
<p>Hay varias maneras de detectar la presencia de colinealidad entre variables independientes:</p>
<ul>
<li><p>Antes de ajustar el modelo, al comparar los coeficientes de correlación.</p></li>
<li><p>Una vez ajustado el modelo, si tenemos un <span class="math inline">\(R^2\)</span> alto y muchas variables independientes que no son estadísticamente significativas.</p></li>
</ul>
<p>Cuando hemos intuido que tenemos multicolinealidad y queremos comprobar, el paquete <code>performance</code> nos ofrece la función <code>check_collinearity()</code> que implementa el método de factor de inflación de la varianza (VIF):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">check_collinearity</span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

               Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI
   mediana_ingresos 1.89 [1.60, 2.31]         1.38      0.53     [0.43, 0.62]
       mediana_edad 1.34 [1.19, 1.63]         1.16      0.75     [0.61, 0.84]
 pct_sec_incompleta 1.28 [1.14, 1.56]         1.13      0.78     [0.64, 0.88]
      pct_desempleo 1.55 [1.34, 1.88]         1.24      0.65     [0.53, 0.75]
             estado 2.52 [2.09, 3.12]         1.59      0.40     [0.32, 0.48]</code></pre>
</div>
</div>
<p>Los resultados del ejemplo muestra VIF de entre 1.28 y 2.52 (no hay colinealidad). Recordemos que el umbral de detección parte de valores cercanos a 5 y un <span class="math inline">\(VIF \geq 10\)</span> indicaría que el modelo de regresión lineal presenta un grado de multicolinealidad preocupante.</p>
</section><section id="análisis-de-residuales" class="level3"><h3 class="anchored" data-anchor-id="análisis-de-residuales">Análisis de residuales</h3>
<p>Como vimos para la regresión lineal simple, podemos analizar gráficamente los residuales con la función <code>check_model()</code> del paquete <code>performance</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">check_model</span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_reg_lineal_multiple_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Por otra parte, también tenemos las funciones de análisis para los supuestos (independencia, linealidad, normalidad, homocedasticidad).</p>
<ul>
<li>
<strong>Independencia:</strong> El paquete <code>lmtest</code> permite evaluar independencia según estadístico de Durbin-Watson.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  mod_full
DW = 2.1769, p-value = 0.7772
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<ul>
<li>
<strong>Linealidad:</strong> El paquete <code>lmtest</code> implementa el <em>Ramsey’s RESET</em> bajo la función <code><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest()</a></code>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  mod_full
RESET = 0.66971, df1 = 2, df2 = 198, p-value = 0.513</code></pre>
</div>
</div>
<ul>
<li>
<strong>Normalidad:</strong> El paquete <code>nortest</code> permite chequear normalidad mediante test de Lilliefors.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  mod_full$residuals
D = 0.060065, p-value = 0.05954</code></pre>
</div>
</div>
<ul>
<li>
<strong>Homocedasticidad:</strong> El paquete <code>performance</code> permite chequear homocedasticidad con el test de Breush-Pagan.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">check_heteroscedasticity</span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p = 0.012).</code></pre>
</div>
</div>
<p>Finalmente presentamos un paquete interesante para validar supuestos de modelos lineales denominado <code>gvlma</code><span class="citation" data-cites="gvlma">(<a href="#ref-gvlma" role="doc-biblioref">Pena y Slate 2019</a>)</span>. Su función, de mismo nombre <code><a href="https://rdrr.io/pkg/gvlma/man/gvlma.html">gvlma()</a></code>, implementa un procedimiento global sobre vector residual estandarizado para probar los cuatro supuestos del modelo lineal.</p>
<p>Si el procedimiento global indica una violación de al menos uno de los supuestos, los componentes se pueden utilizar para obtener información sobre qué supuestos se han violado.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gvlma/man/gvlma.html">gvlma</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_ingresos + mediana_edad + 
    pct_sec_incompleta + pct_desempleo + estado, data = datos)

Coefficients:
        (Intercept)     mediana_ingresos         mediana_edad  
         148.784543            -0.000381             0.500486  
 pct_sec_incompleta        pct_desempleo          estadoMaine  
           0.165173             1.643031            14.617808  
estadoMassachusetts  estadoNew Hampshire     estadoNew Jersey  
           6.388818            11.657941            10.203316  
     estadoNew York   estadoPennsylvania   estadoRhode Island  
           7.908722             9.905042             5.131109  
      estadoVermont  
          13.245742  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = mod_full) 

                    Value p-value                Decision
Global Stat        2.3043  0.6800 Assumptions acceptable.
Skewness           0.9587  0.3275 Assumptions acceptable.
Kurtosis           0.0572  0.8110 Assumptions acceptable.
Link Function      0.4246  0.5147 Assumptions acceptable.
Heteroscedasticity 0.8639  0.3527 Assumptions acceptable.</code></pre>
</div>
</div>
</section><section id="resumen-del-mejor-modelo-elegido" class="level3"><h3 class="anchored" data-anchor-id="resumen-del-mejor-modelo-elegido">Resumen del mejor modelo elegido</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_full</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_ingresos + mediana_edad + 
    pct_sec_incompleta + pct_desempleo + estado, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-31.475  -7.254   1.161   7.192  29.261 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.488e+02  1.487e+01  10.006  &lt; 2e-16 ***
mediana_ingresos    -3.810e-04  8.165e-05  -4.666 5.62e-06 ***
mediana_edad         5.005e-01  2.588e-01   1.934  0.05453 .  
pct_sec_incompleta   1.652e-01  1.945e-01   0.849  0.39681    
pct_desempleo        1.643e+00  5.781e-01   2.842  0.00494 ** 
estadoMaine          1.462e+01  5.662e+00   2.582  0.01054 *  
estadoMassachusetts  6.389e+00  5.344e+00   1.196  0.23328    
estadoNew Hampshire  1.166e+01  5.963e+00   1.955  0.05198 .  
estadoNew Jersey     1.020e+01  5.010e+00   2.036  0.04302 *  
estadoNew York       7.909e+00  4.706e+00   1.680  0.09443 .  
estadoPennsylvania   9.905e+00  4.867e+00   2.035  0.04315 *  
estadoRhode Island   5.131e+00  7.359e+00   0.697  0.48646    
estadoVermont        1.325e+01  5.814e+00   2.278  0.02377 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.93 on 200 degrees of freedom
Multiple R-squared:  0.3373,    Adjusted R-squared:  0.2975 
F-statistic: 8.483 on 12 and 200 DF,  p-value: 6.303e-13</code></pre>
</div>
</div>
<p>El modelo <code>mod_full</code> es capaz de explicar el 29,8% de la variabilidad observada en la tasa de mortalidad por cáncer en estos condados (<span class="math inline">\(R^2_{ajustado} = 0,2975\)</span>). El test <span class="math inline">\(F\)</span> global muestra que es significativo (<span class="math inline">\(p&lt; 0,001\)</span>).</p>
<p>Los coeficientes se pueden interpretar como:</p>
<ul>
<li><p><strong>Mediana de ingresos</strong>: Cada aumento de una unidad en la mediana de ingresos reduce la tasa de mortalidad en 0,0004 unidades.</p></li>
<li><p><strong>Mediana de edad</strong>: Cuando aumento una unidad en la mediana de edad incrementa la tasa de mortalidad en 0,5 unidades.</p></li>
<li><p><strong>Porcentaje de población con secundaria incompleta</strong>: Cada aumento de una unidad en este porcentaje incrementa la tasa de mortalidad en 0,17 unidades, pero esta relación no es significativa.</p></li>
<li><p><strong>Porcentaje de desempleo</strong>: Cada aumento de una unidad en el desempleo incrementa la tasa de mortalidad en 1.64 unidades.</p></li>
<li><p><strong>Estados</strong>: Las tasas de mortalidad varían entre los estados, con algunos efectos significativos, como en Maine, New Jersey, Pennsylvania y Vermont, todos con tasas de mortalidad más altas que el estado de referencia. Es decir, la recta de regresión para cada estado tendrá un intercepto diferente.</p></li>
</ul></section></section><section id="funciones-para-modelado-automático" class="level2"><h2 class="anchored" data-anchor-id="funciones-para-modelado-automático">Funciones para modelado automático</h2>
<p>El uso de la función <code><a href="https://rdrr.io/r/stats/step.html">step()</a></code> se enmarca en los procedimientos automáticos y puede ser <em>forward</em>, <em>backward</em> o mixto. La sintaxis básica de la función es:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">modelo</span>, direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"backward"</span>, <span class="st">"forward"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>donde:</p>
<ul>
<li>
<code>object</code>: es el modelo inicial de regresión lineal (nulo o saturado).</li>
<li>
<code>direction</code>: es la dirección que indicamos. Puede ser <code>"forward"</code>, <code>"backward"</code> o <code>"both"</code> (predeterminado, si no se define).</li>
</ul>
<p>Generalmente conviene partir del modelo saturado y utilizar la dirección por defecto, donde se usan ambas direcciones.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span><span class="va">mod_full</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1068.56
tasa_mortalidad ~ mediana_ingresos + mediana_edad + pct_sec_incompleta + 
    pct_desempleo + estado

                     Df Sum of Sq   RSS    AIC
- estado              8   1470.71 29922 1063.3
- pct_sec_incompleta  1    102.58 28554 1067.3
&lt;none&gt;                            28452 1068.6
- mediana_edad        1    532.09 28984 1070.5
- pct_desempleo       1   1149.28 29601 1075.0
- mediana_ingresos    1   3096.96 31549 1088.6

Step:  AIC=1063.3
tasa_mortalidad ~ mediana_ingresos + mediana_edad + pct_sec_incompleta + 
    pct_desempleo

                     Df Sum of Sq   RSS    AIC
- pct_sec_incompleta  1      79.5 30002 1061.9
&lt;none&gt;                            29922 1063.3
- mediana_edad        1    1033.9 30956 1068.5
- pct_desempleo       1    1036.6 30959 1068.5
+ estado              8    1470.7 28452 1068.6
- mediana_ingresos    1    6922.4 36845 1105.6

Step:  AIC=1061.86
tasa_mortalidad ~ mediana_ingresos + mediana_edad + pct_desempleo

                     Df Sum of Sq   RSS    AIC
&lt;none&gt;                            30002 1061.9
+ pct_sec_incompleta  1      79.5 29922 1063.3
+ estado              8    1447.7 28554 1067.3
- pct_desempleo       1    1176.8 31179 1068.1
- mediana_edad        1    1302.7 31305 1068.9
- mediana_ingresos    1    7528.4 37530 1107.5</code></pre>
</div>
</div>
<p>Observamos que el proceso automático nos indica que debemos eliminar las variables explicativas <code>pct_sec_incompleta</code> y <code>estado</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo_step</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tasa_mortalidad ~ mediana_ingresos + mediana_edad + 
    pct_desempleo, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-31.570  -7.621   1.269   7.564  32.218 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       1.574e+02  1.271e+01  12.388  &lt; 2e-16 ***
mediana_ingresos -4.517e-04  6.237e-05  -7.242 8.34e-12 ***
mediana_edad      7.065e-01  2.345e-01   3.013  0.00291 ** 
pct_desempleo     1.397e+00  4.881e-01   2.863  0.00462 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.98 on 209 degrees of freedom
Multiple R-squared:  0.3012,    Adjusted R-squared:  0.2912 
F-statistic: 30.03 on 3 and 209 DF,  p-value: 3.488e-16</code></pre>
</div>
</div>
<p>Si bien en el ejemplo mostramos como usar el método <em>stepwise</em> automático para la selección de variables, no se recomienda su uso ya que está basado únicamente en criterios matemáticos y no en la relevancia en el mundo real.</p>
<p>Además, cuenta con las siguientes limitaciones:</p>
<ul>
<li><p>Sensibilidad a la selección de variables</p></li>
<li><p>Propensión al sobreajuste</p></li>
<li><p>Violación de supuestos estadísticos</p></li>
<li><p>Inclusión de variables irrelevantes</p></li>
</ul>
<p>Para evitar estos inconvenientes, es recomendable usar métodos alternativos de selección de variables tales como:</p>
<ul>
<li><p><strong>Selección manual de variables</strong>, según su relevancia teórica y conocimiento experto del tema.</p></li>
<li><p><strong>Selección de variables por AIC o BIC</strong> (Criterio de Información Bayesiano).</p></li>
<li>
<p><strong>Regularización</strong> por regresión LASSO (<em>Least Absolute Shrinkage and Selection Operator</em>), que penaliza los coeficientes de las variables menos importantes, favoreciendo modelos más simples y generalizables. Para conocer más sobre este método pueden entrar al siguiente enlace:</p>
<p>➡️ <a href="https://www.lexjansen.com/pnwsug/2008/DavidCassell-StoppingStepwise.pdf"><strong>Stopping stepwise</strong></a></p>
</li>
<li>
<p><strong>Árboles de decisión</strong> (<em>random forest</em> y <em>gradient boosting),</em> herramientas de aprendizaje automático que permiten manejar automáticamente la selección de variables con menor probabilidad de sobreajuste. Para conocer más sobre este método pueden entrar al siguiente enlace:</p>
<p>➡️ <a href="https://www.ibm.com/es-es/think/topics/decision-trees"><strong>Decision trees</strong></a></p>
</li>
</ul>
<p>Estos dos últimos métodos escapan al alcance del curso. Sin embargo, invitamos a quienes tengan interés a explorar las múltiples posibilidades que ofrecen, en particular al momento de analizar datasets grandes y con múltiples variables explicativas.</p>
<div class="hidden">
<p><span class="citation" data-cites="deirala2001">De Irala, Martínez-González, y Guillén Grima (<a href="#ref-deirala2001" role="doc-biblioref">2001a</a>)</span></p>
<p><span class="citation" data-cites="deirala2001a">De Irala, Martínez-González, y Guillén Grima (<a href="#ref-deirala2001a" role="doc-biblioref">2001b</a>)</span></p>
<p><span class="citation" data-cites="gordis2017">Gordis (<a href="#ref-gordis2017" role="doc-biblioref">2017</a>)</span></p>
<p><span class="citation" data-cites="kim2019">Kim (<a href="#ref-kim2019" role="doc-biblioref">2019</a>)</span></p>
<p><span class="citation" data-cites="kleinbaum1988">Kleinbaum et&nbsp;al. (<a href="#ref-kleinbaum1988" role="doc-biblioref">1988</a>)</span></p>
<p><span class="citation" data-cites="macmahon1972">MacMahon (<a href="#ref-macmahon1972" role="doc-biblioref">1972</a>)</span></p>
<p><span class="citation" data-cites="base"> (<a href="#ref-base" role="doc-biblioref">2025</a>)</span></p>
<p><span class="citation" data-cites="tidyverse">Wickham et&nbsp;al. (<a href="#ref-tidyverse" role="doc-biblioref">2019</a>)</span></p>
<p><span class="citation" data-cites="GGally">Schloerke et&nbsp;al. (<a href="#ref-GGally" role="doc-biblioref">2024</a>)</span></p>
<p><span class="citation" data-cites="easystats">Lüdecke et&nbsp;al. (<a href="#ref-easystats" role="doc-biblioref">2022</a>)</span></p>
<p><span class="citation" data-cites="lmtest">Zeileis y Hothorn (<a href="#ref-lmtest" role="doc-biblioref">2002</a>)</span></p>
</div>



</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Volver arriba</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-deirala2001" class="csl-entry" role="listitem">
De Irala, Jokin, Miguel Ángel Martínez-González, y Francisco Guillén Grima. 2001a. <span>«¿Qué es una variable de confusión?»</span> <em>Medicina Clínica</em> 117 (10): 377-85. <a href="https://doi.org/10.1016/S0025-7753(01)72121-5">https://doi.org/10.1016/S0025-7753(01)72121-5</a>.
</div>
<div id="ref-deirala2001a" class="csl-entry" role="listitem">
———. 2001b. <span>«¿Qué es una variable modificadora del efecto?»</span> <em>Medicina Clínica</em> 117 (8): 297-302. <a href="https://doi.org/10.1016/S0025-7753(01)72092-1">https://doi.org/10.1016/S0025-7753(01)72092-1</a>.
</div>
<div id="ref-gordis2017" class="csl-entry" role="listitem">
Gordis, Leon. 2017. <em>Epidemiologia</em>. Thieme Revinter Publicações LTDA.
</div>
<div id="ref-kim2019" class="csl-entry" role="listitem">
Kim, Jong Hae. 2019. <span>«Multicollinearity and Misleading Statistical Results»</span>. <em>Korean Journal of Anesthesiology</em> 72 (6): 558-69. <a href="https://doi.org/10.4097/kja.19087">https://doi.org/10.4097/kja.19087</a>.
</div>
<div id="ref-kleinbaum1988" class="csl-entry" role="listitem">
Kleinbaum, David G, Lawrence L Kupper, Keith E Muller, y Azhar Nizam. 1988. <em>Applied regression analysis and other multivariable methods</em>. Vol. 601. Duxbury press Belmont, CA.
</div>
<div id="ref-easystats" class="csl-entry" role="listitem">
Lüdecke, Daniel, Mattan S. Ben-Shachar, Indrajeet Patil, Brenton M. Wiernik, Etienne Bacher, Rémi Thériault, y Dominique Makowski. 2022. <span>«easystats: Framework for Easy Statistical Modeling, Visualization, and Reporting»</span>. <a href="https://doi.org/10.32614/CRAN.package.easystats">https://doi.org/10.32614/CRAN.package.easystats</a>.
</div>
<div id="ref-macmahon1972" class="csl-entry" role="listitem">
MacMahon, B. 1972. <span>«Concepts of multiple factors»</span>. <em>Multiple factors in the causation of environmentally induced disease. Academic Press, New York</em>.
</div>
<div id="ref-gvlma" class="csl-entry" role="listitem">
Pena, Edsel A., y Elizabeth H. Slate. 2019. <span>«gvlma: Global Validation of Linear Models Assumptions»</span>. <a href="https://CRAN.R-project.org/package=gvlma">https://CRAN.R-project.org/package=gvlma</a>.
</div>
<div id="ref-base" class="csl-entry" role="listitem">
R Core Team. 2025. <span>«R: A Language and Environment for Statistical Computing»</span>. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-GGally" class="csl-entry" role="listitem">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg, y Jason Crowley. 2024. <span>«GGally: Extension to ’ggplot2’»</span>. <a href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et&nbsp;al. 2019. <span>«Welcome to the <span></span>tidyverse<span></span>»</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-lmtest" class="csl-entry" role="listitem">
Zeileis, Achim, y Torsten Hothorn. 2002. <span>«Diagnostic Checking in Regression Relationships»</span> 2. <a href="https://CRAN.R-project.org/doc/Rnews/">https://CRAN.R-project.org/doc/Rnews/</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reutilización</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.es">CC BY-NC 4.0</a></div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/datos-ine\.github\.io\/curso_avanzada_2025\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Este material es parte del curso de Epidemiología - Nivel Avanzado © 2025 Instituto Nacional de Epidemiología “Dr.&nbsp;Juan H. Jara” (ANLIS)</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>